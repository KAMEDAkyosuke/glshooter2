/*
 bulletml.js v0.5.0-SNAPSHOT

 License
 http://daishihmr.mit-license.org/
*/
function g(a){throw a;}var j=void 0,k=!0,l=null,n=!1;function p(){return function(){}}var q={Se:this};
(function(){function a(a,c){for(var f=0,d=a.length;f<d;f++)if(a[f].label==c)return a[f]}q.Aa=function(a){this.type='none';this.root=this;this.Fa=[];this.Ic=[];this.Nc=[];if(a!==j){for(var c in a)a.hasOwnProperty(c)&&(a[c].label=c,a[c]instanceof q.Ra?this.Fa.push(a[c]):a[c]instanceof q.ka?this.Ic.push(a[c]):a[c]instanceof q.Ub&&this.Nc.push(a[c]));a=0;for(c=this.Fa.length;a<c;a++)this.Fa[a].Ta(this);a=0;for(c=this.Ic.length;a<c;a++)this.Ic[a].Ta(this);a=0;for(c=this.Nc.length;a<c;a++)this.Nc[a].Ta(this)}};
q.Aa.prototype.le=function(b){return a(this.Fa,b)};q.Aa.prototype.Uf=function(){for(var a=[],c=0,f=this.Fa.length;c<f;c++){var d=this.Fa[c];d.label&&0===d.label.indexOf('top')&&(a[a.length]=d.label)}return a};q.Aa.prototype.Lf=function(a){var c;if(c=this.le(a))return c;g(Error("action labeled '"+a+"' is undefined."))};q.Aa.prototype.Mf=function(b){return a(this.Ic,b)};q.Aa.prototype.Nf=function(a){var c;if(c=this.Mf(a))return c;g(Error("bullet labeled '"+a+"' is undefined."))};q.Aa.prototype.Of=function(b){return a(this.Nc,
b)};q.Aa.prototype.Pf=function(a){var c;if(c=this.Of(a))return c;g(Error("fire labeled '"+a+"' is undefined."))};q.ka=function(){this.root=this.label=l;this.direction=new q.nb(0);this.speed=new q.qb(1);this.Fa=[];this.Ka={};this.ja={}};q.ka.prototype.clone=function(a){var c=new q.ka;c.label=this.label;c.root=this.root;c.Fa=this.Fa;c.direction=new q.nb(a.Ha(this.direction.value));c.direction.type=this.direction.type;c.speed=new q.qb(a.Ha(this.speed.value));c.speed.type=this.speed.type;c.Ka=this.Ka;
c.ja=a.ja;return c};q.ka.prototype.Ta=function(a){this.root=a;for(var c=0,f=this.Fa.length;c<f;c++)this.Fa[c].Ta(a)};q.uc=function(a){this.root=l;this.label=a;this.Da=[]};q.uc.prototype.clone=function(a){var c=a.ja;a.ja=a.nd(this.Da);var f=this.root.Nf(this.label).clone(a);a.ja=c;return f};q.uc.prototype.Ta=function(a){this.root=a};q.Ea=function(){this.Oa=''};q.Ea.prototype.Ta=function(a){this.root=a};q.Ra=function(){this.Oa='action';this.root=this.label=l;this.Wa=[];this.Da=[]};q.Ra.prototype=new q.Ea;
q.Ra.prototype.Ta=function(a){this.root=a;for(var c=0,f=this.Wa.length;c<f;c++)this.Wa[c].Ta(a)};q.Ra.prototype.clone=function(){var a=new q.Ra;a.label=this.label;a.root=this.root;a.Wa=this.Wa;return a};q.Tb=function(a){this.Oa='actionRef';this.label=a;this.root=l;this.Da=[]};q.Tb.prototype=new q.Ea;q.Tb.prototype.clone=function(){var a=new q.Ra;a.root=this.root;a.Wa.push(this);return a};q.Ub=function(){this.Oa='fire';this.ea=this.speed=this.direction=this.root=this.label=l;this.Ka=new q.ed};q.Ub.prototype=
new q.Ea;q.Ub.prototype.Ta=function(a){this.root=a;this.ea&&this.ea.Ta(a)};q.fd=function(a){this.Oa='fireRef';this.label=a;this.Da=[]};q.fd.prototype=new q.Ea;q.vc=function(){this.Oa='changeDirection';this.direction=new q.nb;this.La=0};q.vc.prototype=new q.Ea;q.wc=function(){this.Oa='changeSpeed';this.speed=new q.qb;this.La=0};q.wc.prototype=new q.Ea;q.tc=function(){this.Oa='accel';this.jb=new q.gd;this.mb=new q.ld;this.La=0};q.tc.prototype=new q.Ea;q.Ac=function(a){this.Oa='wait';this.value=a||0};
q.Ac.prototype=new q.Ea;q.kd=function(){this.Oa='vanish'};q.kd.prototype=new q.Ea;q.zc=function(){this.Oa='repeat';this.Ee=0;this.action=l;this.Da=[]};q.zc.prototype=new q.Ea;q.zc.prototype.Ta=function(a){this.root=a;this.action&&this.action.Ta(a)};q.bd=function(a,c){this.Oa='bind';this.ng=a;this.Jf=c};q.bd.prototype=new q.Ea;q.hd=function(a,c){this.Oa='notify';this.Ef=a;this.Da=c||l};q.hd.prototype=new q.Ea;q.Qe=new q.Ea;q.nb=function(a){this.type='aim';this.value=a||0};q.qb=function(a){this.type=
'absolute';this.value=a===j?1:a};q.gd=function(a){this.type='absolute';this.value=a||0};q.ld=function(a){this.type='absolute';this.value=a||0};q.ed=function(a){a=a||{};this.offsetX=a.offsetX||0;this.offsetY=a.offsetY||0;this.ua=k;a.ua!==j&&(this.ua=!!a.ua)};q.Rd=function(a){this.value=a||0};q.Sd=function(a){this.value=a||0};q.Ld=function(a){this.value=!!a}})();q.ub=function(a){this.Wd=a;this.Bc=[];this.vb=-1;this.Ga=l;this.ja={}};
q.ub.prototype.next=function(){this.vb+=1;if(this.Ga!==l){var a=this.Ga.Wa[this.vb];if(a!==j){if(a instanceof q.Ra)return this.fc(),this.Ga=a,this.ja=this.md(),this.next();if(a instanceof q.Tb)return this.fc(),this.Ga=this.Wd.Lf(a.label),this.ja=this.nd(a.Da),this.next();if(a instanceof q.zc)return this.ja.$b=0,this.ja.te=this.Ha(a.Ee)|0,this.fc(),this.Ga=a.action.clone(),this.ja=this.md(),this.next();if(a instanceof q.Ub){var b=new q.Ub;b.ea=a.ea.clone(this);a.direction!==l&&(b.direction=new q.nb(this.Ha(a.direction.value)),
b.direction.type=a.direction.type);a.speed!==l&&(b.speed=new q.qb(this.Ha(a.speed.value)),b.speed.type=a.speed.type);b.Ka=a.Ka;return b}return a instanceof q.fd?(this.fc(),this.Ga=new q.Ra,this.Ga.Wa=[this.Wd.Pf(a.label)],this.ja=this.nd(a.Da),this.next()):a instanceof q.vc?(b=new q.vc,b.direction.type=a.direction.type,b.direction.value=this.Ha(a.direction.value),b.La=this.Ha(a.La),b):a instanceof q.wc?(b=new q.wc,b.speed.type=a.speed.type,b.speed.value=this.Ha(a.speed.value),b.La=this.Ha(a.La),b):
a instanceof q.tc?(b=new q.tc,b.jb.type=a.jb.type,b.jb.value=this.Ha(a.jb.value),b.mb.type=a.mb.type,b.mb.value=this.Ha(a.mb.value),b.La=this.Ha(a.La),b):a instanceof q.Ac?new q.Ac(this.Ha(a.value)):a instanceof q.kd?a:a instanceof q.bd?(this.ja['$'+a.ng]=this.Ha(a.Jf),q.Qe):a instanceof q.hd?a:l}this.vf();if(this.Ga===l)return l;if((a=this.Ga.Wa[this.vb])&&'repeat'==a.Oa)this.ja.$b++,this.ja.$b<this.ja.te&&(this.fc(),this.Ga=a.action.clone(),this.ja=this.md());return this.next()}return l};
q.ub.prototype.fc=function(){this.Bc.push({action:this.Ga,cursor:this.vb,scope:this.ja});this.vb=-1};q.ub.prototype.vf=function(){var a=this.Bc.pop();a?(this.vb=a.cursor,this.Ga=a.action,this.ja=a.scope):(this.vb=-1,this.Ga=l,this.ja={})};
q.ub.prototype.Ha=function(a){var b;if('number'===typeof a)return a;if(isNaN(b=Number(a))){if((b=this.ja[a])||(b=q.ka.sa[a]))return b;if('$rand'===a)return Math.random()}else return b;b={};for(var c in q.ka.sa)q.ka.sa.hasOwnProperty(c)&&(b[c]=q.ka.sa[c]);for(c in this.ja)this.ja.hasOwnProperty(c)&&(b[c]=this.ja[c]);b.$rand=Math.random();(c=this.Bc[this.Bc.length-1])&&(b.$loop={index:c.scope.$b,count:c.scope.$b+1,first:0===c.scope.$b,last:c.scope.$b+1>=c.scope.te});return(new Function('return '+a.split('$').join('this.$'))).apply(b)};
q.ub.prototype.nd=function(a){var b={};if(a)for(var c=0,f=a.length;c<f;c++)b['$'+(c+1)]=this.Ha(a[c]);else for(c in this.ja)this.ja.hasOwnProperty(c)&&(b[c]=this.ja[c]);return b};q.ub.prototype.md=function(){var a={},b;for(b in this.ja)this.ja.hasOwnProperty(b)&&(a[b]=this.ja[b]);return a};q.Aa.prototype.vd=function(a){var b=new q.ub(this);if(a=this.le(a))b.Ga=a;return b};q.ka.prototype.vd=function(){var a=new q.ub(this.root),b=new q.Ra;b.root=this.root;b.Wa=this.Fa;a.Ga=b;a.ja=this.ja;return a};
q.ka.sa={};q.oa=function(a){a=a||'';for(var b in q.oa)q.oa.hasOwnProperty(b)&&(q.Se[a+b]=q.oa[b])};
q.oa.action=function(a){if(0<arguments.length)for(var b=0,c=arguments.length;b<c;b++)arguments[b]instanceof Function&&(arguments[b]=arguments[b]());if(a instanceof Array){b=0;for(c=a.length;b<c;b++)a[b]instanceof Function&&(a[b]=a[b]())}var f=new q.Ra;if(a instanceof Array)a.some(function(a){return!(a instanceof q.Ea)})&&g(Error('argument type error.')),f.Wa=a;else{b=0;for(c=arguments.length;b<c;b++)arguments[b]instanceof q.Ea?f.Wa[b]=arguments[b]:g(Error('argument type error.'))}return f};
q.oa.tg=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('label is required.'));f=new q.Tb(a);if(b instanceof Array)f.Da=b;else for(c=1;c<arguments.length;c++)f.Da.push(arguments[c]);return f};
q.oa.ea=function(a,b,c,f){for(var d=0,i=arguments.length;d<i;d++)arguments[d]instanceof Function&&(arguments[d]=arguments[d]());i=new q.ka;for(d=0;d<arguments.length;d++)arguments[d]instanceof q.nb?i.direction=arguments[d]:arguments[d]instanceof q.qb?i.speed=arguments[d]:arguments[d]instanceof q.Ra?i.Fa.push(arguments[d]):arguments[d]instanceof q.Tb?i.Fa.push(arguments[d]):arguments[d]instanceof Array?i.Fa.push(q.oa.action(arguments[d])):arguments[d]instanceof Object?i.Ka=arguments[d]:'string'===
typeof arguments[d]&&(i.label=arguments[d]);return i};q.oa.vg=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('label is required.'));f=new q.uc(a);if(b instanceof Array)f.Da=b;else for(c=1;c<arguments.length;c++)f.Da.push(arguments[c]);return f};
q.oa.ga=function(a,b,c,f){for(var d=0,i=arguments.length;d<i;d++)arguments[d]instanceof Function&&(arguments[d]=arguments[d]());i=new q.Ub;for(d=0;d<arguments.length;d++)arguments[d]instanceof q.nb?i.direction=arguments[d]:arguments[d]instanceof q.qb?i.speed=arguments[d]:arguments[d]instanceof q.ka?i.ea=arguments[d]:arguments[d]instanceof q.uc?i.ea=arguments[d]:arguments[d]instanceof q.ed?i.Ka=arguments[d]:arguments[d]instanceof q.Rd?i.Ka.offsetX=arguments[d].value:arguments[d]instanceof q.Sd?i.Ka.offsetY=
arguments[d].value:arguments[d]instanceof q.Ld&&(i.Ka.ua=arguments[d].value);i.ea===j&&g(Error('bullet (or bulletRef) is required.'));return i};q.oa.Bg=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('label is required.'));f=new q.fd(a);if(b instanceof Array)f.Da=b;else for(c=1;c<arguments.length;c++)f.Da.push(arguments[c]);return f};
q.oa.wg=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('direction is required.'));b===j&&g(Error('term is required.'));c=new q.vc;c.direction=a instanceof q.nb?a:new q.nb(a);c.La=b;return c};
q.oa.xg=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('speed is required.'));b===j&&g(Error('term is required.'));c=new q.wc;c.speed=a instanceof q.qb?a:new q.qb(a);c.La=b;return c};
q.oa.sg=function(a,b,c){for(var f=0,d=arguments.length;f<d;f++)arguments[f]instanceof Function&&(arguments[f]=arguments[f]());d=new q.tc;for(f=0;f<arguments.length;f++)arguments[f]instanceof q.gd?d.jb=a:arguments[f]instanceof q.ld?d.mb=b:d.La=arguments[f];d.jb===j&&d.mb===j&&g(Error('horizontal or vertical is required.'));d.La===j&&g(Error('term is required.'));return d};
q.oa.wait=function(a){for(var b=0,c=arguments.length;b<c;b++)arguments[b]instanceof Function&&(arguments[b]=arguments[b]());a===j&&g(Error('value is required.'));return new q.Ac(a)};q.oa.Lg=function(){return new q.kd};
q.oa.repeat=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('times is required.'));b===j&&g(Error('action is required.'));f=new q.zc;f.Ee=a;if(b instanceof q.Ra||b instanceof q.Tb)f.action=b;else if(b instanceof Array)f.action=q.oa.action(b);else{for(var d=[],c=1;c<arguments.length;c++)d.push(arguments[c]);f.action=q.oa.action(d)}return f};q.oa.ug=function(a,b){return new q.bd(a,b)};
q.oa.Hg=function(a,b){return new q.hd(a,b)};q.oa.direction=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('value is required.'));c=new q.nb(a);b!==j&&(c.type=b);return c};q.oa.speed=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('value is required.'));c=new q.qb(a);b&&(c.type=b);return c};
q.oa.jb=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('value is required.'));c=new q.gd(a);b&&(c.type=b);return c};q.oa.mb=function(a,b){for(var c=0,f=arguments.length;c<f;c++)arguments[c]instanceof Function&&(arguments[c]=arguments[c]());a===j&&g(Error('value is required.'));c=new q.ld(a);b&&(c.type=b);return c};q.oa.Ag=function(a){return new q.ed(a)};q.oa.offsetX=function(a){return new q.Rd(a)};q.oa.offsetY=function(a){return new q.Sd(a)};
q.oa.ua=function(a){return new q.Ld(a)};tm.Na=tm.Na||{};
(function(){function a(a){for(;a<=-Math.PI;)a+=2*Math.PI;for(;Math.PI<a;)a-=2*Math.PI;return a}function b(a,c){return Math.atan2(c.y-a.y,c.x-a.x)}tm.Na.Hb=tm.createClass({init:function(a){a||g(Error('argument is invalid.',a));this.Td=a},Kc:function(a,c){var b=this.Td.Uf();if(c===j&&0<b.length){for(var f=[],s=0,h=b.length;s<h;s++)f[f.length]=this.Ud(a,b[s]);for(var z=function(){for(var a=f.length;a--;)f[a].call(this);z.sd==f.length&&(z.jc=k,this.dispatchEvent(tm.event.Event('completeattack')))},s=
f.length;s--;)f[s].Yc=z;z.sd=0;z.be=function(){this.sd++};z.sd=0;z.jc=n;z.zd=k;return z}return this.Ud(a,c)},Ud:function(a,c){function b(){b.ha+=1;this.ha=b.ha;var a=b.Jc,c=b.uf;if(c)if(b.ha<b.qd?b.direction+=b.Xb:b.ha===b.qd&&(b.direction=b.xb),b.ha<b.rd?b.speed+=b.sc:b.ha===b.rd&&(b.speed=b.dc),b.ha<b.od?(b.Qb+=b.Ec,b.Sb+=b.Fc):b.ha===b.od&&(b.Qb=b.Cc,b.Sb=b.Dc),this.x+=Math.cos(b.direction)*b.speed*a.Rb,this.y+=Math.sin(b.direction)*b.speed*a.Rb,this.x+=b.Qb*a.Rb,this.y+=b.Sb*a.Rb,a.Ad(this)){if(a.Fb||
this.Fb)this.rotation=(b.direction+0.5*Math.PI)*Math.RAD_TO_DEG,this.speed=b.speed;if(!(b.ha<b.Fe||b.jc)){for(var d;d=b.Ge.next();)switch(d.Oa){case 'fire':c.rf.call(this,d,a,b,c);break;case 'wait':a=0;b.Fe='number'===typeof d.value?b.ha+d.value:0!==(a=~~d.value)?b.ha+a:b.ha+eval(d.value);return;case 'changeDirection':c.nf.call(this,d,a,b);break;case 'changeSpeed':c.of.call(this,d,b);break;case 'accel':c.lf.call(this,d,b);break;case 'vanish':this.remove();break;case 'notify':c.sf.call(this,d)}b.jc=
k;b.Yc?b.Yc.be():this.dispatchEvent(tm.event.Event('completeattack'))}}else this.remove(),b.jc=k,b.Yc?b.Yc.be():this.dispatchEvent(tm.event.Event('completeattack'))}a=function(a){var b={},c=tm.Na.Hb.lc,d;for(d in c)c.hasOwnProperty(d)&&(b[d]=c[d]);for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}(a);a.target||g(Error('target is undefined in config.'));c=c||'top';'string'===typeof c?b.Ge=this.Td.vd(c):c instanceof q.ka?b.Ge=c.vd():(window.console.error(a,c),g(Error('\u5f15\u6570\u304c\u4e0d\u6b63')));
b.uf=this;b.Jc=a;b.Fe=-1;b.jc=n;b.direction=0;b.qe=0;b.speed=0;b.se=0;b.Qb=0;b.Sb=0;b.Xb=0;b.xb=0;b.qd=-1;b.sc=0;b.dc=0;b.rd=-1;b.Ec=0;b.Cc=0;b.Fc=0;b.Dc=0;b.od=-1;b.ha=-1;b.zd=k;return b},qf:function(a){function b(){this.x+=b.de;this.y+=b.ee;b.Jc.Ad(this)||(this.remove(),this.dispatchEvent(tm.event.Event('removed')))}a=function(a){var b={},c=tm.Na.Hb.lc,d;for(d in c)c.hasOwnProperty(d)&&(b[d]=c[d]);for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}(a);a.target||g(Error('target is undefined in config.'));
b.Jc=a;b.direction=0;b.speed=0;b.de=0;b.ee=0;b.zd=k;return b},rf:function(a,c,f,r){if(this.fg===j||this.eb){var s={label:a.ea.label},h;for(h in a.ea.Ka)s[h]=a.ea.Ka[h];if(s=c.$d(s)){var z=(h=!!a.ea.Fa.length)?r.qf(c):r.Kc(c,a.ea),M=this,W={x:this.x+a.Ka.offsetX,y:this.y+a.Ka.offsetY};f.qe=z.direction=function(h){var r=eval(h.value)*Math.DEG_TO_RAD;switch(h.type){case 'aim':return c.target?a.Ka.ua?b(W,c.target)+r:b(M,c.target)+r:r-Math.PI/2;case 'absolute':return r-Math.PI/2;case 'relative':return f.direction+
r;default:return f.qe+r}}(a.direction||a.ea.direction);f.se=z.speed=function(a){var b=eval(a.value);switch(a.type){case 'relative':return f.speed+b;case 'sequence':return f.se+b;default:return b}}(a.speed||a.ea.speed);s.x=W.x;s.y=W.y;h&&(z.de=Math.cos(z.direction)*z.speed*c.Rb,z.ee=Math.sin(z.direction)*z.speed*c.Rb);s.Fb=!!s.Fb;if(c.Fb||s.Fb)s.rotation=(z.direction+0.5*Math.PI)*Math.RAD_TO_DEG,s.speed=z.speed;s.addEventListener('enterframe',z);s.addEventListener('removed',function(){this.removeEventListener('enterframe',
z);this.removeEventListener('removed',arguments.callee)});c.Yd?c.Yd.addChild(s):this.parent&&this.parent.addChild(s)}}},nf:function(c,f,m){var r=eval(c.direction.value)*Math.DEG_TO_RAD,s=eval(c.La);switch(c.direction.type){case 'aim':c=f.target;if(!c)return;m.xb=b(this,c)+r;m.Xb=a(m.xb-m.direction)/s;break;case 'absolute':m.xb=r-Math.PI/2;m.Xb=a(m.xb-m.direction)/s;break;case 'relative':m.xb=m.direction+r;m.Xb=a(m.xb-m.direction)/s;break;case 'sequence':m.Xb=r,m.xb=m.direction+m.Xb*(s-1)}m.qd=m.ha+
s},of:function(a,b){var c=eval(a.speed.value),f=eval(a.La);switch(a.speed.type){case 'absolute':b.dc=c;b.sc=(b.dc-b.speed)/f;break;case 'relative':b.dc=c+b.speed;b.sc=(b.dc-b.speed)/f;break;case 'sequence':b.sc=c,b.dc=b.speed+b.sc*f}b.rd=b.ha+f},lf:function(a,b){var c=eval(a.La);b.od=b.ha+c;if(a.jb){var f=eval(a.jb.value);switch(a.jb.type){case 'absolute':case 'sequence':b.Ec=(f-b.Qb)/c;b.Cc=f;break;case 'relative':b.Ec=f,b.Cc=(f-b.Qb)*c}}else b.Ec=0,b.Cc=b.Qb;if(a.mb)switch(f=eval(a.mb.value),a.mb.type){case 'absolute':case 'sequence':b.Fc=
(f-b.Sb)/c;b.Dc=f;break;case 'relative':b.Fc=f,b.Dc=(f-b.Sb)*c}else b.Fc=0,b.Dc=b.Sb},sf:function(a){var b=tm.event.Event(a.Ef);if(a.Da)for(var c in a.Da)b[c]=a.Da[c];this.dispatchEvent(b)}});var c=function(){var a=tm.graphics.Canvas();a.resize(8,8);a.setTransformCenter();a.setLineStyle(0).setStrokeStyle('rgba(0,0,0,0)');a.setFillStyle(tm.graphics.RadialGradient(0,0,0,0,0,4).addColorStopList([{offset:0,color:'white'},{offset:0.5,color:'white'},{offset:1,color:'red'}]).toStyle()).fillCircle(0,0,4);
return a}();tm.Na.Bf=function(a){var b=tm.app.Sprite(8,8,c);b.label=a.label;return b};var f=l;tm.Na.ce=function(a){f===l&&(f=a.getRoot());return 0<=a.x&&a.x<APP.width&&0<=a.y&&a.y<APP.height};tm.Na.zg=function(){return k};tm.Na.Hb.lc={$d:tm.Na.Bf,Ad:tm.Na.ce,Jg:0,Fb:n,Rb:2,target:l,sa:{}};q.Aa.prototype.Kc=function(a){return tm.Na.Hb(this).Kc(a)}})();/*
 gls2.js v1.0-beta

 License
 http://daishihmr.mit-license.org/
*/
tm.preload(p());tm.main(function(){aa('#canvas2d').run()});var t=l,u,v,w,A,B,C,D,E,ba,F,ca,da,G,H,ea,I,fa,ga,J,ha,ia,ja,ka,la,K,ma,na,L,N,O,aa=tm.createClass({superClass:tm.app.CanvasApp,Sc:0,Fg:0,Gc:1,cc:1,fe:1,ke:[1E9,1E10],$:l,init:function(a){t!==l&&g(Error("class 'gls2.GlShooter2' is singleton!!"));this.superInit(a);t=this;this.resize(480,640).fitWindow();this.fps=60;this.background='rgba(0,0,0,0)';this.keyboard=tm.input.Keyboard(window);this.replaceScene(tm.app.LoadingScene({assets:{tex0:'assets/tex0.png',tex1:'assets/tex1.png',laserR:'assets/laser_r.png',
laserG:'assets/laser_g.png',laserB:'assets/laser_b.png',laserH:'assets/laser_h.png',laserHead:'assets/laser_head.png',laserFoot:'assets/laser_foot.png',aura:'assets/aura.png',explode0:'assets/explode0.png',explode1:'assets/explode1.png',shotbullet:'assets/shotbullet.png',bomb:'assets/bomb.png',soundExplode:'assets/sen_ge_taihou03.mp3',soundExplode2:'assets/sen_ge_bom13.mp3',soundExplode3:'assets/sen_ge_bom02.mp3',star:'assets/star.png'},nextScene:function(){this.tf();return u()}.bind(this)}))},draw:function(){this.canvas.globalCompositeOperation=
'copy'},tf:function(){v.ta();w.ta();this.$=A()},Gf:function(){this.stop();tm.social.Nineleap.postRanking(this.Sc,'')}});function P(a){if(0!==t.cc&&oa[a]!==t.frame){var b=tm.asset.AssetManager.get(a);b.volume=0.1*t.cc;b&&b.clone().play();oa[a]=t.frame}}var oa={};tm.app.AnimationSprite.prototype.clone=function(){return tm.app.AnimationSprite(this.ss,this.width,this.height)};function Q(a,b){return(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y)};B={Od:3,Nd:3,gf:1,df:2,ef:2,cf:4,He:2,Ve:4,Je:8,$e:0.01,Ye:0.015,Ze:0.001,We:0.015,Xe:0.002,af:0.75,bf:2,Md:800,Ue:200,Te:120,Pe:7,Ne:0.02,Oe:0.5,Me:0.01,cd:200,Le:10,kf:200,jf:100,Re:0.3,dd:4E4,Ke:20,hf:10,Ie:n};(function(){var a=l,b={'0':{x:1,y:0},45:{x:0.7,y:-0.7},90:{x:0,y:-1},135:{x:-0.7,y:-0.7},180:{x:-1,y:0},225:{x:-0.7,y:0.7},270:{x:0,y:1},315:{x:0.7,y:0.7}};C=tm.createClass({superClass:tm.app.Sprite,type:0,$a:0,rb:k,ac:n,$:l,speed:4.5,Lb:l,Wb:l,ve:l,oe:l,lb:l,Tc:l,Hc:l,xd:l,yd:l,init:function(b,f){this.superInit('tex1',64,64);this.type=f;this.$=b;tm.Na.Hb.lc.target=this;this.boundingRadius=2;this.altitude=10;this.Wb=this.ve=D(f,100);this.oe=D(3,100);this.lb=E(this,{redBody:'laserR',greenBody:'laserG',
blueBody:'laserB',hyperBody:'laserH',head:'laserHead',foot:'laserFoot',aura:'aura'});this.lb.visible=n;this.lb.addChildTo(b);this.pf();this.Lb=[{x:-70,y:20,d:0.1,Eb:n,yb:-0.7,v:k},{x:-40,y:40,d:0.1,Eb:n,yb:-0.5,v:k},{x:40,y:40,d:0.1,Eb:k,yb:0.5,v:k},{x:70,y:20,d:0.1,Eb:k,yb:0.7,v:k}];this.Hc=tm.app.CanvasElement().addChildTo(this);for(var d=0,i=this.Lb.length;d<i;d++){var m=this.Lb[d];ba(this,m).setPosition(m.x,m.y).addChildTo(this.Hc)}this.Yf=tm.app.CircleShape(140,140,{strokeStyle:'rgba(0,0,0,0)',
fillStyle:tm.graphics.RadialGradient(70,70,0,70,70,70).addColorStopList([{offset:0,color:'rgba(255,255,255,0.1)'},{offset:0.5,color:'rgba(255,255,255,0.1)'},{offset:1,color:'rgba(255,255,255,0.0)'}]).toStyle()}).addChildTo(this);this.Yf.blendMode='lighter';this.xd=tm.app.CircleShape(80,80,{fillStyle:'rgba(0,0,0,0)',strokeStyle:tm.graphics.LinearGradient(0,0,0,80).addColorStopList([{offset:0,color:'rgba(255,255,100,0.0)'},{offset:0.4,color:'rgba(255,255,100,0.1)'},{offset:0.5,color:'rgba(255,255,255,1.0)'},
{offset:0.6,color:'rgba(255,255,100,0.1)'},{offset:1,color:'rgba(255,255,100,0.0)'}]).toStyle(),lineWidth:4}).addChildTo(this);this.xd.blendMode='lighter';this.xd.update=function(){this.rotation+=2;this.visible=1===b.ya&&!b.ra};this.yd=tm.app.CircleShape(80,80,{fillStyle:'rgba(0,0,0,0)',strokeStyle:tm.graphics.LinearGradient(0,0,0,80).addColorStopList([{offset:0,color:'rgba(255,255,100,0.0)'},{offset:0.4,color:'rgba(255,255,100,0.1)'},{offset:0.5,color:'rgba(255,255,255,1.0)'},{offset:0.6,color:'rgba(255,255,100,0.1)'},
{offset:1,color:'rgba(255,255,100,0.0)'}]).toStyle(),lineWidth:4}).addChildTo(this);this.yd.blendMode='lighter';this.yd.update=function(){this.rotation-=2;this.visible=1===b.ya&&!b.ra};this.nc=tm.app.CanvasElement(80,80).addChildTo(this);this.nc.blendMode='lighter';this.nc.rotation=-90;this.nc.strokeStyle='rgba(180,180,255,0.4)';this.nc.update=function(){this.visible=b.ra};this.nc.draw=function(a){a.lineCap='round';var d=b.Yb/B.Md;a.strokeStyle='rgba(50,50,255,0.4)';a.lineWidth='10';a.strokeArc(0,
0,40,0,2*d*Math.PI,n);a.strokeStyle='rgba(100,100,255,0.4)';a.lineWidth='6';a.strokeArc(0,0,40,0,2*d*Math.PI,n);a.strokeStyle='rgba(180,180,255,0.4)';a.lineWidth='2';a.strokeArc(0,0,40,0,2*d*Math.PI,n)};this.Vf=tm.app.CircleShape(80,80,{fillStyle:tm.graphics.RadialGradient(40,40,0,40,40,35).addColorStopList([{offset:0,color:'rgba(0,0,50,0.0)'},{offset:0.9,color:'rgba(0,0,50,0.8)'},{offset:1,color:'rgba(0,0,50,0.0)'}]).toStyle(),strokeStyle:'rgba(0,0,0,0)'}).addChildTo(this);this.Vf.update=function(){this.visible=
b.ra};a===l&&(a=F(this.$.va))},rg:function(){return[{x:-70,y:20,d:0.1,Eb:n,yb:-0.7,v:k},{x:-40,y:40,d:0.1,Eb:n,yb:-0.5,v:k},{x:40,y:40,d:0.1,Eb:k,yb:0.5,v:k},{x:70,y:20,d:0.1,Eb:k,yb:0.7,v:k}]},pf:function(){this.Tc=tm.app.Sprite('tex0',20,20).addChildTo(this);this.Tc.setFrameIndex(5);this.Tc.blendMode='lighter';this.Tc.update=function(a){a=0.75+0.15*Math.sin(0.2*a.frame);this.scale.set(a,a)}},Db:-1,Mc:n,zb:n,update:function(c){this.visible=this.ac?0===c.frame%2:k;var f=c.keyboard;if(this.rb){var d=
f.getKeyAngle();d!==l&&(d=b[d],this.x+=d.x*this.speed*(this.zb?0.75:1),this.y+=d.y*this.speed*(this.zb?0.75:1));this.x=R(this.x,15,465);this.y=R(this.y,15,625);var i=f.getKey('c'),d=f.getKey('z');this.Db=i?this.Db+1:this.Db-1;this.Db=R(this.Db,-1,10);this.zb=d&&i||10===this.Db;i=this.$.ra?3:5;this.Mc=!this.zb&&(0<=this.Db||d)&&0===c.frame%i;d&&(this.Db=0);this.lb.x=this.x;this.lb.y=this.y-40;if(this.zb){d=0;for(i=this.Lb.length;d<i;d++)this.Lb[d].v=n;this.Hc.rotation=0}else{this.lb.visible=n;d=0;
for(i=this.Lb.length;d<i;d++)this.Lb[d].v=k}this.Mc&&(d=Math.sin(0.2*c.frame),i=this.Wb.ga(this.x-7-6*d,this.y-5,-90),i!==l&&i.addChildTo(this.$),i=this.Wb.ga(this.x+7+6*d,this.y-5,-90),i!==l&&i.addChildTo(this.$));f.getKeyDown('x')&&(1===this.$.ya&&!this.$.ra?(this.$.kg(),ca(this).addChildTo(this.$)):!this.$.Zb&&0<this.$.cb&&(this.Ja=R(this.Ja-2,0,1),q.ka.sa.$rank=R(q.ka.sa.$rank-0.02,0,1),da(this,this.$).setPosition(R(this.x,96,384),Math.max(this.y-320,192)).addChildTo(this.$)))}this.Af(f);this.mf(f);
0===c.frame%2&&(a.clone(20).setPosition(this.x-5,this.y+20).addChildTo(this.$),a.clone(20).setPosition(this.x+5,this.y+20).addChildTo(this.$))},Mb:function(){this.zb=this.Mc=n;this.$.mc();this.$.xa=0;this.$.Ca=0;this.$.qa=0},Af:function(a){var b=this.Hc;b.rotation=this.rb&&a.getKey('left')?Math.max(b.rotation-3,-40):this.rb&&a.getKey('right')?Math.min(b.rotation+3,40):3<b.rotation?b.rotation-3:-3>b.rotation?b.rotation+3:0},mf:function(a){this.rb&&a.getKey('left')?this.$a=R(this.$a-0.2,-3,3):this.rb&&
a.getKey('right')?this.$a=R(this.$a+0.2,-3,3):0>this.$a?this.$a=R(this.$a+0.2,-3,3):0<this.$a&&(this.$a=R(this.$a-0.2,-3,3));a=3+~~this.$a;this.setFrameIndex(a);return a}});ba=tm.createClass({superClass:tm.app.AnimationSprite,Kb:l,ba:l,init:function(a,b){this.superInit(tm.app.SpriteSheet({image:'tex1',frame:{width:32,height:32},animations:{anim0:{frames:[136,137,138,152,153,154],next:'anim0',frequency:3},anim1:{frames:[137,138,152,153,154,136].reverse(),next:'anim1',frequency:3}}}),32,32);this.Kb=
b;this.ba=a;this.altitude=10;this.gotoAndPlay(b.Eb?'anim0':'anim1')},update:function(b){if(this.Kb.v){this.x=this.Kb.x*(this.ba.$.ra?1.5:1);this.y=this.Kb.y*(this.ba.$.ra?1.5:1);this.rotation=Math.radToDeg(this.Kb.d*this.Kb.yb);var f=this.parent.localToGlobal(this);this.Kb.v&&0===b.frame%2&&a.clone(40).setPosition(f.x,f.y).addChildTo(b.$);this.ba.Mc&&(f=this.ba.Wb.ga(f.x,f.y,this.parent.rotation+this.rotation-90),f!==l&&f.addChildTo(b.$))}else this.x=0,this.y=-40,this.currentFrameIndex=3}})})();(function(){var a=l;G=tm.createClass({superClass:tm.app.Sprite,speed:0,Pa:k,init:function(b){this.superInit('shotbullet',64,64);this.blendMode='lighter';a===l&&(a=H(16,1,0.9,tm.graphics.Canvas().resize(16,16).setFillStyle(tm.graphics.RadialGradient(8,8,0,8,8,8).addColorStopList([{offset:0,color:'rgba(255,255,255,1.0)'},{offset:1,color:'rgba(255,128,  0,0.0)'}]).toStyle()).fillRect(0,0,16,16).element));b!==j&&this.rc(b)},update:function(){this.x+=this.og;this.y+=this.pg;(-60>this.x||540<this.x||-60>
this.y||700<this.y)&&this.remove()},rc:function(a){this.setFrameIndex(a,64,64);3===a?(this.speed=45,this.boundingRadius=48,this.setScale(2,2)):(this.speed=30,this.boundingRadius=32,this.setScale(1.5,1.5))},Pc:function(b){for(var f=0;f<b;f++){var d=a.clone().setPosition(this.x,this.y).addChildTo(this.parent),i=S(2,8),m=2*Math.random()*Math.PI;d.la=Math.cos(m)*i;d.ma=Math.sin(m)*i;d.scaleX=d.scaleY=(S(0.1,0.5)+S(0.1,0.5))/2;d.addEventListener('enterframe',function(){this.x+=this.la;this.y+=this.ma;
this.la*=0.9;this.ma*=0.9})}}});G.ic=function(){for(var a=[].concat(b),f=0,d=a.length;f<d;f++)a[f].remove()};var b=G.Ia=[];D=tm.createClass({Zc:l,init:function(a,f){this.Zc=[];for(var d=0;d<f;d++){var i=G(a),m=this;i.addEventListener('added',function(){this.wa=B.hf;b.push(this)});i.addEventListener('removed',function(){var a=b.indexOf(this);-1!==a&&b.splice(a,1);m.Zc.push(this)});this.Zc.push(i)}},ga:function(a,b,d){var i=this.Zc.pop();if(i===j)return l;var m=pa(d);i.og=Math.cos(m)*i.speed;i.pg=Math.sin(m)*
i.speed;i.setPosition(a,b);i.rotation=d+90;return i}})})();(function(){var a=l;E=tm.createClass({superClass:tm.app.Sprite,ba:l,$:l,Va:0,frame:0,De:l,color:l,xf:n,head:l,me:l,Zd:l,Pa:k,init:function(a,c){this.ba=a;this.$=a.$;var f=this;this.De=c;this.superInit(c.redBody,50,100);this.boundingHeightBottom=1;this.Kg=0;this.origin.y=1;var d=this.Zd=tm.app.AnimationSprite(tm.app.SpriteSheet({image:c.aura,frame:{width:100,height:100},animations:{red:{frames:[0,1,2,3],next:'red',frequency:2},green:{frames:[4,5,6,7],next:'green',frequency:2},blue:{frames:[8,9,10,
11],next:'blue',frequency:2},hyper:{frames:[12,13,14,15],next:'hyper',frequency:2}}}),140,140);d.y=60;d.addChildTo(this);(this.me=tm.app.AnimationSprite(tm.app.SpriteSheet({image:c.foot,frame:{width:120,height:80},animations:{red:{frames:[0,1,2,3],next:'red',frequency:2},green:{frames:[4,5,6,7],next:'green',frequency:2},blue:{frames:[8,9,10,11],next:'blue',frequency:2},hyper:{frames:[12,13,14,15],next:'hyper',frequency:2}}}),140,80)).addChildTo(this);d=this.head=tm.app.AnimationSprite(tm.app.SpriteSheet({image:c.head,
frame:{width:80,height:80},animations:{red:{frames:[0,1,2,3],next:'red',frequency:2},green:{frames:[4,5,6,7],next:'green',frequency:2},blue:{frames:[8,9,10,11],next:'blue',frequency:2},hyper:{frames:[12,13,14,15],next:'hyper',frequency:2}}}),130,130);d.addChildTo(this);d.update=function(){this.y=f.Va-f.y;-10<this.y&&(this.y=-10);this.visible=0<f.Va};this.rc('blue')},rc:function(b){this.color=b;this.image=tm.asset.AssetManager.get(this.De[this.color+'Body']);this.srcRect.x=0;this.srcRect.y=0;this.srcRect.width=
this.image.width/16;this.Zd.gotoAndPlay(this.color);this.me.gotoAndPlay(this.color);this.head.gotoAndPlay(this.color);a=H(16,1,0.9,tm.graphics.Canvas().resize(16,16).setFillStyle(tm.graphics.RadialGradient(8,8,0,8,8,8).addColorStopList([{offset:0,color:'rgba(255,255,255,1.0)'},{offset:1,color:'rgba(  0,  0,255,0.0)'}]).toStyle()).fillRect(0,0,16,16).element);'hyper'===b?(this.boundingWidth=this.width=75,this.head.setScale(1.5,1.5)):(this.boundingWidth=this.width=50,this.head.setScale(1,1));return this},
Pc:function(b,c){c=c||this.Va;for(var f=0;f<b;f++){var d=a.clone().setPosition(this.x,c).addChildTo(this.$),i=S(8,14),m=S(0,Math.PI);d.la=Math.cos(m)*i;d.ma=Math.sin(m)*i;d.scaleX=d.scaleY=(S(0.5,1.5)+S(0.5,1.5))/2;d.addEventListener('enterframe',function(){this.x+=this.la;this.y+=this.ma;this.la*=0.95;this.ma*=0.95})}},Sf:function(b,c,f){c=c||this.x;f=f||this.Va;for(var d=0;d<b;d++){var i=a.clone().setPosition(c,f).addChildTo(this.$),m=S(12,20),r=S(0,Math.PI);i.la=Math.cos(r)*m;i.ma=Math.sin(r)*
m;i.scaleX=i.scaleY=(S(1,3)+S(1,3))/2;i.addEventListener('enterframe',function(){this.x+=this.la;this.y+=this.ma;this.la*=0.95;this.ma*=0.95})}},update:function(a){(this.visible=this.ba.zb)?(this.Va=Math.max(0,this.Va-40),this.height=this.y-this.Va,0===a.frame%3&&(this.frame=(this.frame+1)%16)):this.Va=this.y-40;this.xf=this.visible},draw:function(a){var c=this.srcRect,f=this._image.element;c.x=c.width*this.frame;a.context.drawImage(f,c.x,c.height-this.height,c.width,this.height,-this.width*this.origin.x,
-this.height*this.origin.y,this.width,this.height)},Eg:function(){return this.Va},jg:function(a){this.Va=a;this.head.update()}});E.prototype.getter('boundingHeightTop',function(){return this.position.y-this.Va})})();(function(){da=tm.createClass({superClass:tm.app.Object2D,Pa:k,$:l,init:function(b,c){this.superInit();this.ba=b;this.$=c;this.ze=tm.app.CircleShape(300,300,{strokeStyle:'rgba(0,0,0,0)',fillStyle:tm.graphics.RadialGradient(150,150,0,150,150,150).addColorStopList([{offset:0,color:'rgba(255,255,255,0)'},{offset:0.5,color:'rgba(255,255,255,0)'},{offset:0.9,color:'rgba(255,255,255,1)'},{offset:1,color:'rgba(255,255,255,0)'}]).toStyle()}).setScale(0.1,0.1).addChildTo(this);this.ze.tweener.clear().to({scaleX:5,
scaleY:5,alpha:0},500,'easeOutQuad').call(function(){this.remove()}.bind(this.ze));this.Xd();a===l&&(a=H(60,1,0.92,tm.graphics.Canvas().resize(10,10).setFillStyle(tm.graphics.RadialGradient(5,5,0,5,5,5).addColorStopList([{offset:0,color:'rgba(255,255,255,1.0)'},{offset:1,color:'rgba(  0,  0,255,0.0)'}]).toStyle()).fillRect(0,0,10,10).element));this.r=this.a=0;this.b=8;this.ha=0;this.qc=1;this.addEventListener('added',function(){this.$.Zb=k;this.ba.ac=k;this.$.cb-=1;this.$.mc();this.$.Qa('drop BOMBER!!',
k)});this.addEventListener('removed',function(){this.$.Zb=n;this.ba.ac=n})},Xd:function(){this.Xa=tm.app.AnimationSprite(tm.app.SpriteSheet({image:'bomb',frame:{width:280,height:280},animations:{animation:{frames:Array.range(0,8),next:'animation',frequency:3}}}),400,400).addChildTo(this);this.Xa.gotoAndPlay('animation');this.Xa.blendMode='lighter';this.Xa.setScale(0.1,0.1);this.Xa.tweener.clear().to({scaleX:1,scaleY:1},200,'easeOutBack').call(function(){this.update=function(){this.scaleX=this.scaleY=
S(0.9,1.1)}}.bind(this.Xa))},update:function(){for(var b=0;b<this.b;b++){var c=this.a*this.qc+2*b*Math.PI/this.b;a.clone().setPosition(Math.cos(c)*this.r+this.x,Math.sin(c)*this.r+this.y).addChildTo(this.parent)}this.a+=0.04;b=0.015*this.ha;this.r=250*Math.sin(b);2*Math.PI<b?this.remove():Math.PI<b?(this.b=16,this.ha+=3.6,this.qc=-1):(this.b=8,this.ha+=1.8,this.qc=1)}});ea=tm.createClass({superClass:da,init:function(a,c){this.superInit(a,c);B.Ie&&this.addEventListener('added',function(){this.$.cb=
0})},Xd:function(){this.Xa=tm.app.AnimationSprite(tm.app.SpriteSheet({image:'bomb',frame:{width:280,height:280},animations:{animation:{frames:Array.range(0,8),next:'animation',frequency:3}}}),400,400).addChildTo(this);this.Xa.gotoAndPlay('animation');this.Xa.blendMode='lighter';this.Xa.setScale(0.1,0.1);this.Xa.tweener.clear().to({scaleX:0.5,scaleY:0.5},200,'easeOutBack').call(function(){this.update=function(){this.scaleX=this.scaleY=S(0.4,0.6)}}.bind(this.Xa))},update:function(){for(var b=0;b<this.b;b++){var c=
this.a*this.qc+2*b*Math.PI/this.b;a.clone().setPosition(Math.cos(c)*this.r+this.x,Math.sin(c)*this.r+this.y).setScale(0.7,0.7).addChildTo(this.parent)}this.a+=0.04;b=0.04*this.ha;this.r=100*Math.sin(b);Math.PI<b?this.remove():(this.b=8,this.ha+=1.8,this.qc=1)}});var a=l})();I=tm.createClass({ba:l,$:l,aa:l,frame:0,init:function(a){this.$=a;this.ba=a.ba;this.ye();this.aa=fa();this.frame=0},ye:p(),update:function(){this.Ff(this.frame);this.frame+=1},Ff:function(a){a=this.aa.get(a);if(a!==l)if('function'===typeof a.value)a.value.call(this);else if(ga[a.value]!==j){var b=ga[a.value];if(b!==l)for(var c=0;c<b.length;c++){var f=this.Xf(b[c]);a.stop&&f.addEventListener('enemyconsumed',function(){this.aa.Kd=n}.bind(this))}}},Xf:function(a){this.$.he+=1;return J(this.$,this,a.ca,
a.da).setPosition(a.x,a.y).addChildTo(this.$).Nb()},Ig:p()});I.create=function(a,b){if(0===b)return ha(a)};fa=tm.createClass({index:0,data:l,Kd:n,init:function(){this.data={}},add:function(a,b,c){this.index+=a;this.data[this.index]={stop:c,value:b}},get:function(a){a=this.data[a];return a===j?l:a.stop===k?(this.Kd=k,a):this.Kd?l:a}});ha=tm.createClass({superClass:I,init:function(a){this.superInit(a);this.aa.add(0,function(){this.$.va.direction=0.5*Math.PI;this.$.va.speed=1});this.aa.add(200,'tankRD-center');this.aa.add(200,'tankRD-left');this.aa.add(20,'heri1-right');this.aa.add(60,'heri1-center');this.aa.add(10,'cannon-0');this.aa.add(60,'heri1-left');this.aa.add(10,'cannon-1');this.aa.add(60,'tankL-top');this.aa.add(10,'cannon-1');this.aa.add(50,'heri1-right');this.aa.add(20,'tankRD-center');this.aa.add(80,'heri1-center');this.aa.add(150,
'komachi-1');this.aa.add(500,'heri1-right');this.aa.add(20,'heri1-center');this.aa.add(20,'heri1-left');this.aa.add(20,'tankL-top');this.aa.add(20,'tankRD-left');this.aa.add(50,'heri1-right');this.aa.add(50,'heri1-center');this.aa.add(50,'heri1-center');this.aa.add(20,'tankRD-center');this.aa.add(20,'tankRD-left');this.aa.add(50,'heri1-right');this.aa.add(10,'cannon-7');this.aa.add(1,'cannon-6');this.aa.add(1,'cannon-5');this.aa.add(50,'heri1-center');this.aa.add(50,'heri1-left');this.aa.add(20,'tankL-top');
this.aa.add(50,'heri1-right');this.aa.add(50,'fighter-m-1');this.aa.add(50,'fighter-m-5');this.aa.add(1,function(){this.$.va.tweener.clear().to({speed:5},5E3,'easeInOutQuad')});this.aa.add(150,'yukishiro',k);this.aa.add(50,'heri2-left');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(60,'heri1-center');this.aa.add(50,'heri2-left');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(50,'fighter-m-0');this.aa.add(50,'fighter-m-2');this.aa.add(50,'fighter-m-4');
this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(50,'heri2-left');this.aa.add(10,'cannon-6');this.aa.add(1,'cannon-5');this.aa.add(1,'cannon-4');this.aa.add(60,'heri1-center');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(50,'fighter-m-6');this.aa.add(50,'fighter-m-4');this.aa.add(50,'fighter-m-2');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(50,'heri2-left');this.aa.add(60,'heri1-center');this.aa.add(50,'heri2-center');
this.aa.add(50,'heri2-right');this.aa.add(50,'fighter-m-0');this.aa.add(50,'fighter-m-1');this.aa.add(50,'fighter-m-2');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(10,'cannon-1');this.aa.add(1,'cannon-2');this.aa.add(1,'cannon-3');this.aa.add(50,'heri2-left');this.aa.add(60,'heri1-center');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(50,'fighter-m-6');this.aa.add(50,'fighter-m-5');this.aa.add(50,'fighter-m-4');this.aa.add(50,'heri2-center');
this.aa.add(50,'heri2-right');this.aa.add(50,'heri2-left');this.aa.add(60,'heri1-center');this.aa.add(50,'heri2-center');this.aa.add(50,'heri2-right');this.aa.add(60,'heri1-center');this.aa.add(100,'komachi-0');this.aa.add(100,'komachi-1')},ye:function(){this.$.va.background=tm.graphics.LinearGradient(0,0,0,640).addColorStopList([{offset:0,color:'hsl(230,50%,45%)'},{offset:1,color:'hsl(230,50%,25%)'}]).toStyle()}});w={ta:function(){qa(256);w.explosion=Array.range(0,2).map(function(a){return tm.app.AnimationSprite(tm.app.SpriteSheet({image:'explode'+a,frame:{width:100,height:100},animations:{'default':{frame:Array.range(0,64),next:l}}},100,100))});w.shockwaveImage=tm.graphics.Canvas().resize(100,100).setStrokeStyle('rgba(0,0,0,0)').setFillStyle(tm.graphics.RadialGradient(50,50,0,50,50,50).addColorStopList([{offset:0,color:'rgba(255,255,255,0)'},{offset:0.7,color:'rgba(255,255,255,0)'},{offset:0.95,color:'rgba(255,255,255,1)'},
{offset:1,color:'rgba(255,255,255,0)'}]).toStyle()).fillCircle(50,50,50);w.shockwaveImage=tm.graphics.Canvas().resize(100,100).setStrokeStyle('rgba(0,0,0,0)').setFillStyle(tm.graphics.RadialGradient(50,50,0,50,50,50).addColorStopList([{offset:0,color:'rgba(255,255,255,0)'},{offset:0.7,color:'rgba(255,255,255,0)'},{offset:0.95,color:'rgba(255,255,255,1)'},{offset:1,color:'rgba(255,255,255,0)'}]).toStyle()).fillCircle(50,50,50);w.particle16=H(16,1,0.9,tm.graphics.Canvas().resize(16,16).setFillStyle(tm.graphics.RadialGradient(8,
8,0,8,8,8).addColorStopList([{offset:0,color:'rgba(255,255,255,1.0)'},{offset:1,color:'rgba(255,128,  0,0.0)'}]).toStyle()).fillRect(0,0,16,16).element)},Pc:function(a,b,c){a=w.particle16.clone().setPosition(a,b).addChildTo(c);b=S(5,20);c=S(Math.PI,2*Math.PI);a.la=Math.cos(c)*b;a.ma=Math.sin(c)*b;a.scaleX=a.scaleY=(S(0.1,0.5)+S(0.1,0.5))/2;a.addEventListener('enterframe',function(){this.x+=this.la;this.y+=this.ma;this.la*=0.9;this.ma*=0.9})},Dg:function(a,b,c){var f=tm.app.Sprite().setPosition(a,
b).setScale(0.1).setBlendMode('lighter').addChildTo(c);f.image=w.shockwaveImage;f.tweener.clear().to({scaleX:1.4,scaleY:1.4,alpha:0},800,'easeOutQuad').call(function(){f.remove()})},Tf:function(a,b,c){a=tm.app.CircleShape(300,300,{strokeStyle:'rgba(0,0,0,0)',fillStyle:tm.graphics.RadialGradient(150,150,0,150,150,150).addColorStopList([{offset:0,color:'rgba(255,255,255,0)'},{offset:0.5,color:'rgba(255,255,255,0)'},{offset:0.9,color:'rgba(255,255,255,1)'},{offset:1,color:'rgba(255,255,255,0)'}]).toStyle()}).setPosition(a,
b).setScale(0.1,0.1);a.Pa=k;a.addChildTo(c);a.tweener.clear().to({scaleX:5,scaleY:5,alpha:0},500,'easeOutQuad').call(function(){this.remove()}.bind(a))},Lc:function(a,b,c,f){P('soundExplode');a=w.explosion.random().clone().addEventListener('animationend',function(){this.remove()}).setScale(0.75).setPosition(a,b).setRotation(360*Math.random()).gotoAndPlay();a.Pa=k;if(f!==j){var d=f.x,i=f.y;a.addEventListener('enterframe',function(){this.x+=d;this.y+=i;d*=0.99;i*=0.99})}a.addChildTo(c)},Hf:function(a,
b,c){P('soundExplode');var f=w.explosion.random().clone().addEventListener('animationend',function(){this.remove()}).addEventListener('enterframe',function(){this.scaleX+=0.01;this.scaleY+=0.01}).setScale(0.5).setPosition(a,b).setRotation(360*Math.random()).gotoAndPlay();f.Pa=k;f.addChildTo(c);f=w.explosion.random().clone().addEventListener('animationend',function(){this.remove()}).addEventListener('enterframe',function(){this.rotation+=2;this.x+=0.7;this.y-=0.3;this.scaleX+=0.01;this.scaleY+=0.01}).setScale(0.5).setPosition(a+
12,b).setRotation(360*Math.random()).setBlendMode('lighter').gotoAndPlay();f.Pa=k;f.addChildTo(c);f=w.explosion.random().clone().addEventListener('animationend',function(){this.remove()}).addEventListener('enterframe',function(){this.rotation-=2;this.x-=0.7;this.y-=0.3;this.scaleX+=0.01;this.scaleY+=0.01}).setScale(0.5).setPosition(a-12,b).setRotation(360*Math.random()).setBlendMode('lighter').gotoAndPlay();f.Pa=k;f.addChildTo(c)},If:function(a,b,c){P('soundExplode2');P('soundExplode3');for(var f=
~~(Math.random()*T.length),d=0;20>d;d++){var i=w.explosion.random().clone().addEventListener('animationend',function(){this.remove()}).addEventListener('enterframe',function(){this.x+=Math.cos(this.a)*this.v;this.y+=Math.sin(this.a)*this.v;this.scaleX+=0.01;this.scaleY+=0.01}).setScale(0.7).setBlendMode(0===d%2?'lighter':'source-over').setPosition(a,b).gotoAndPlay();i.a=2*Math.PI*Math.random();i.v=10*Math.pow(T.at(~~(T.length*d/20)+f),2);i.Pa=k;i.addChildTo(c)}},je:function(a,b,c){P('soundExplode2');
P('soundExplode3');for(var f=~~(Math.random()*T.length),d=0;60>d;d++){var i=w.explosion.random().clone().addEventListener('animationend',function(){this.remove()}).addEventListener('enterframe',function(){this.x+=Math.cos(this.a)*this.v;this.y+=Math.sin(this.a)*this.v;this.scaleX+=0.01;this.scaleY+=0.01}).setScale(1).setBlendMode(0===d%2?'source-over':'lighter').setPosition(a,b).gotoAndPlay();i.a=2*Math.PI*d/60;i.v=30*Math.pow(T.at(~~(T.length*d/60)+f),3);i.Pa=k;i.addChildTo(c)}}};
ia=tm.createClass({superClass:tm.app.Object2D,target:l,Pb:0,angle:0,alpha:1,Pa:k,reverse:n,init:function(a,b){this.superInit();this.target=a;this.reverse=b;this.angle=0;this.Pb=b?0:200;this.alpha=b?1:0},update:function(){if(this.target.parent===l)this.remove();else{for(var a=0;9>a;a++){var b=this.angle+2*a/9*Math.PI;H(80,this.alpha,0.9).setPosition(Math.cos(b)*this.Pb+this.target.x,Math.sin(b)*this.Pb+this.target.y).addChildTo(this.target.parent)}this.angle+=0.05;this.Pb+=this.reverse?4:-4;this.alpha+=
this.reverse?-0.01:0.05;(0>this.Pb||200<this.Pb)&&this.remove()}}});ca=tm.createClass({superClass:tm.app.Object2D,target:l,angle:0,Pa:k,init:function(a){this.superInit();this.target=a;this.angle=0},update:function(){if(this.target.parent===l)this.remove();else{for(var a=0;5>a;a++)H(80,1,0.9).setPosition(40*Math.cos(this.angle-0.5*Math.PI)+this.target.x+U(-2,2),40*Math.sin(this.angle-0.5*Math.PI)+this.target.y+U(-2,2)).addChildTo(this.target.parent);this.angle+=0.2;2*Math.PI<this.angle&&this.remove()}}});ja=tm.createClass({superClass:tm.graphics.Canvas,$:l,kc:l,init:function(a){this.superInit('#scoreLabel');this.$=a;this.resize(480,640).fitWindow();this.setText('20px Orbitron','left','top');this.fillStyle='rgba(255,255,255,0.01)';this.kc=ra(200)},update:function(){this.clear();this.strokeStyle=this.fillStyle='rgba(255,255,255,0.4)';var a;this.setText("20px 'Ubuntu Mono'",'right','top');score=(''+Math.floor(this.$.score)).padding(16,' ');a='';for(var b=0;b<score.length;b+=4)a+=score.substring(b,b+
4)+' ';this.fillText(a,192,5);this.setText("18px 'Ubuntu Mono'",'right','top');score=('+'+Math.floor(this.$.xa)).padding(8,' ');a='';for(b=0;b<score.length;b+=4)a+=score.substring(b,b+4)+' ';this.fillText(a,192,22);this.setText('bold 18px Orbitron','left','top');this.strokeText('rank '+~~(100*q.ka.sa.$rank),10,75);this.setText('bold 18px Orbitron','left','top');this.strokeText('max '+~~this.$.Wc+' hit',10,95);0<~~this.$.qa&&(this.setText('bold 40px Orbitron','left','top'),this.strokeText(~~this.$.qa+
' HIT!!',10,115));for(b=0;b<this.$.Gb-1;b++)this.drawTexture(tm.asset.AssetManager.get('tex1'),192,0,64,64,5+32*b,40,32,32);this.fillStyle='rgba(255,255,255,0.5)';for(b=0;b<this.$.cb;b++)this.fillRect(5+25*b,601,20,20);this.kc.update();this.kc.draw(this)}});(function(){var a=16*Math.sqrt(3),b=12.8*Math.sqrt(3);ka=tm.createClass({superClass:tm.graphics.Canvas,fa:l,init:function(){this.superInit('#background');this.resize(480,640).fitWindow();this.fa=la();this.fa.va=this;this.fa.update=function(a){this.update(a.frame)}.bind(this);this.blendMode='lighter'},update:function(c){this.fa.la=Math.cos(this.fa.direction)*this.fa.speed;this.fa.ma=Math.sin(this.fa.direction)*this.fa.speed;for(this.fa.fb+=this.fa.la;96<this.fa.fb;)this.fa.fb-=96;for(;-96>this.fa.fb;)this.fa.fb+=
96;for(this.fa.hb+=this.fa.ma;2*a<this.fa.hb;)this.fa.hb-=2*a;for(;this.fa.hb<2*-a;)this.fa.hb+=2*a;for(this.fa.gb+=0.8*this.fa.la;25.6*3<this.fa.gb;)this.fa.gb-=25.6*3;for(;this.fa.gb<-25.6*3;)this.fa.gb+=25.6*3;for(this.fa.ib+=0.8*this.fa.ma;2*b<this.fa.ib;)this.fa.ib-=2*b;for(;this.fa.ib<2*-b;)this.fa.ib+=2*b;0===c%2&&this.draw()},draw:function(){this.fa.background!==l?this.clearColor(this.fa.background,0,0):this.clear();this.lineWidth=0.2;this.strokeStyle=tm.graphics.LinearGradient(0,0,0,640).addColorStopList([{offset:0,
color:'rgba(255,255,255,1.0)'},{offset:1,color:'rgba(255,255,255,0.5)'}]).toStyle();this.beginPath();for(var c=0,f=this.fa.fb-96;576>f;f+=48)for(var c=0===c?a:0,d=this.fa.hb-2*a+c;d<640+2*a;d+=2*a)this.line(f,d,f+32,d),this.line(f,d,f-16,d+a),this.line(f,d,f-16,d-a);this.stroke();this.strokeStyle=tm.graphics.LinearGradient(0,0,0,640).addColorStopList([{offset:0,color:'rgba(128,128,128,1.0)'},{offset:1,color:'rgba(128,128,128,0.5)'}]).toStyle();this.beginPath();c=0;for(f=this.fa.gb-25.6*3;f<480+25.6*
3;f+=25.6*1.5){c=0===c?b:0;for(d=this.fa.ib-2*b+c;d<640+2*b;d+=2*b)this.line(f,d,f+25.6,d),this.line(f,d,f-12.8,d+b),this.line(f,d,f-12.8,d-b)}this.stroke()}});la=tm.createClass({superClass:tm.app.Object2D,fb:0,hb:0,gb:0,ib:0,direction:0,speed:0,la:0,ma:0,background:l,init:function(){this.superInit();this.gb=this.ib=this.fb=this.hb=0;this.direction=0.5*Math.PI;this.speed=1;this.ma=this.la=0}})})();K=tm.createClass({superClass:tm.app.Sprite,pe:n,$:l,ba:l,Rc:n,Id:n,la:0,ma:0,init:function(a){this.superInit('star',20,20);(this.pe=a)&&this.setScale(2,2);this.$=A.jd;this.ba=this.$.ba;this.addChildTo(this.$);a=0.5*Math.random()*Math.PI-0.75*Math.PI;this.la=30*Math.cos(a);this.ma=30*Math.sin(a)},update:function(){this.ba.zb&&(this.Rc=k);if(this.ba.parent===l)this.Rc=n;else{if(100>Q(this,this.ba)){this.$.Zf(this);this.remove();return}1E4>Q(this,this.ba)&&(this.Rc=k);if(this.Id&&this.Rc){var a=Math.atan2(this.ba.y-
this.y,this.ba.x-this.x);this.x+=10*Math.cos(a);this.y+=10*Math.sin(a)}else this.Id||(this.x+=this.la,this.y+=this.ma,this.la*=0.8,this.ma*=0.8,-1<this.la&&(1>this.la&&-1<this.ma&&1>this.ma)&&(this.Id=k))}(-200>this.x||680<this.x||-200>this.y||690<this.y)&&this.remove()}});ma=tm.createClass({superClass:K,init:function(a){this.superInit(a)},update:function(){this.y+=4;this.rotation+=10;this.superClass.prototype.update.call(this)}});
na=tm.createClass({superClass:K,init:function(a){this.superInit(a)},update:function(){this.x+=this.$.va.la;this.y+=this.$.va.ma;this.superClass.prototype.update.call(this)}});function V(a,b){if(a.parent===l||b.parent===l)return n;var c=a.x+a.boundingWidthRight,f=a.y-a.boundingHeightTop,d=a.y+a.boundingHeightBottom,i=b.x-b.boundingWidthLeft,m=b.y-b.boundingHeightTop,r=b.y+b.boundingHeightBottom;return a.x-a.boundingWidthLeft<b.x+b.boundingWidthRight&&c>i&&f<r&&d>m};var X=tm.createClass({superClass:tm.app.Scene,_sceneResultCallback:l,init:function(){this.superInit()},lg:function(a,b){'function'===typeof a?this.app.pushScene(a()):a instanceof tm.app.Scene&&this.app.pushScene(a);this._sceneResultCallback=b},finish:function(a){var b=this.app;b.popScene();(b=b.currentScene)&&b._sceneResultCallback&&b._sceneResultCallback.bind(b)(a)}});var sa=tm.createClass({superClass:X,titleText:l,menu:l,descriptions:l,showExit:n,title:l,selections:[],description:l,box:l,cursor:l,_selected:0,_opened:n,_finished:n,init:function(a,b,c,f,d){this.superInit();this.titleText=a;this.menu=b;this._selected=~~c;this.showExit=!!d;this.descriptions=f?f:[].concat(b);this.showExit&&(b.push('exit'),this.descriptions.push('\u524d\u306e\u753b\u9762\u3078\u623b\u308a\u307e\u3059'));a=Math.max(50*(1+b.length),50)+40;this.box=tm.app.RectangleShape(384,a,{strokeStyle:'rgba(0,0,0,0)',
fillStyle:'rgba(1,2,48,0.8)'}).setPosition(240,320);this.box.width=1;this.box.height=1;this.box.tweener.to({width:384,height:a},200,'easeOutExpo').call(this._onOpen.bind(this));this.box.addChildTo(this);this.description=tm.app.Label('',14).setPosition(240,630).addChildTo(this)},_onOpen:function(){var a=320-25*this.menu.length;this.title=tm.app.Label(this.titleText,30).setPosition(240,a).addChildTo(this);this.selections=this.menu.map(function(b,c){var f=this;a+=50;var d=tm.app.Label(b).setPosition(240,
a).addChildTo(this);d.interactive=k;d.addEventListener('touchend',function(){f._selected===c?f.closeDialog(f._selected):f._selected=c});d.width=336;return d}.bind(this));this._createCursor();this._opened=k},_createCursor:function(){this.cursor=tm.app.RectangleShape(336,10,{strokeStyle:'rgba(0,0,0,0)',fillStyle:tm.graphics.LinearGradient(0,0,336,0).addColorStopList([{offset:0,color:'rgba(  0,255,100,0.0)'},{offset:0.2,color:'rgba(  0,255,100,0.3)'},{offset:0.5,color:'rgba(  0,255,255,0.5)'},{offset:0.8,
color:'rgba(  0,255,100,0.3)'},{offset:1,color:'rgba(  0,255,100,0.0)'}]).toStyle()}).addChildTo(this);this.cursor.blendMode='lighter';this.cursor.x=240;this.cursor.s=this._selected;this.cursor.y=this.selections[this._selected].y;this.cursor.update=function(){this.s!==this.parent._selected&&(this.s=this.parent._selected,this.tweener.clear(),this.tweener.to({y:this.parent.selections[this.parent._selected].y},200,'easeOutExpo'))}},update:function(a){this.description.text=this.descriptions[this._selected];
this._opened&&(this._finished?this.cursor.visible=0===~~(a.frame/2)%2:this.showExit&&a.keyboard.getKeyDown('x')?(this._selected=this.selections.length-1,this.closeDialog(this._selected)):a.keyboard.getKeyDown('z')||a.keyboard.getKeyDown('space')?this.closeDialog(this._selected):a.keyboard.getKeyDown('down')?(this._selected+=1,this._selected=R(this._selected,0,this.selections.length-1)):a.keyboard.getKeyDown('up')&&(this._selected-=1,this._selected=R(this._selected,0,this.selections.length-1)))},closeDialog:function(a){this._finished=
k;this.tweener.clear().wait(200).call(function(){this.cursor.remove();this.title.remove();this.selections.each(function(a){a.remove()});this.box.tweener.clear();this.box.tweener.to({width:1,height:1},200,'easeInExpo').call(function(){this.finish(a)}.bind(this))}.bind(this))},draw:function(a){a.fillStyle='rgba(0,0,0,0.8)';a.fillRect(0,0,480,640)}});function Y(a,b,c,f,d,i,m){m===j&&(m=k);a.lg(sa(b,c,d,i,m),f)};H=tm.createClass({superClass:tm.app.CanvasElement,alpha:1,pd:0.85,size:0,image:l,Pa:k,init:function(a,b,c,f){this.superInit();this.width=this.height=this.size=a;b!==j&&(this.alpha=b);c!==j&&(this.pd=c);this.blendMode='lighter';this.image=f?f:tm.graphics.Canvas().resize(a,a).setFillStyle(tm.graphics.RadialGradient(0.5*a,0.5*a,0,0.5*a,0.5*a,0.5*a).addColorStopList([{offset:0,color:'rgba(255,255,255,0.1)'},{offset:1,color:'rgba(  0,  0,  0,0.0)'}]).toStyle()).fillRect(0,0,a,a).element},update:function(){this.alpha*=
this.pd;0.001>this.alpha?this.remove():1<this.alpha&&(this.alpha=1)},draw:function(a){a.context.drawImage(this.image,-this.width*this.origin.x,-this.height*this.origin.y,this.width,this.height)},clone:function(){return H(this.size,this.Gg,this.pd,this.image)}});
F=tm.createClass({superClass:H,va:l,init:function(a,b){b=b||20;this.superInit(b,1,0.82,tm.graphics.Canvas().resize(b,b).setFillStyle(tm.graphics.RadialGradient(0.5*b,0.5*b,0,0.5*b,0.5*b,0.5*b).addColorStopList([{offset:0,color:'rgba(255,255,255,0.5)'},{offset:1,color:'rgba(  0,  0,  0,0.0)'}]).toStyle()).fillRect(0,0,b,b).element);this.va=a},update:function(a){this.superClass.prototype.update.apply(this,a);this.x+=this.va.la;this.y+=this.va.ma+0.3},clone:function(a){return F(this.va,a)}});var ra=tm.createClass({width:0,label:l,Ma:l,ha:0,init:function(a){this.width=a;this.label=tm.app.Label('_',10).setAlign('left').setBaseline('top').setPosition(-this.width/2+4,-this.height/2+4).setFillStyle('rgba(255,255,255,0.5)');this.Ma=[]},wf:function(a,b){b===k&&(this.Ma.clear(),this.Ma.push(''));5<this.Ma.length&&this.Ma.splice(1,this.Ma.length-4);this.Ma.push(a);return this},zf:function(){this.Ma.clear();return this},clear:function(){this.label.text='_';return this},update:function(){var a=
this.label.text,a=a.substring(0,a.length-1);if(0!==this.Ma.length)if(''!==this.Ma[0]){var b=this.Ma[0][0];this.Ma[0]=this.Ma[0].substring(1);a+=b}else this.Ma.shift(),b=a.split('\n'),3<b.length&&(b.shift(),a=b.join('\n')),a+='\n';this.label.text=a+(0===this.ha%2?'_':' ');this.ha+=1},draw:function(a){a.save();a.context.globalCompositeOperation='source-over';a.translate(480-this.width-5,5);a.fillStyle='rgba(1,2,48,0.5)';a.fillRect(0,0,this.width,64);a.translate(5,5);a.fillStyle='rgba(255,255,255,0.5)';
a.setText(this.label.fontStyle,this.label.align,this.label.baseline);this.label._lines.each(function(b,c){a.fillText(b,0,this.label.textSize*c)}.bind(this));a.restore()}});function qa(a){function b(b){if(1>b)return l;var d=[],f=Math.random(),i,m;for(m=0;m<a;m+=~~b){i=Math.random();for(var r=0;r<b;r++)d[m+r]=c(f,i,r/b);f=i}f=d[a-~~b];i=d[0];for(r=0;r<b;r++)d[a-~~b+r]=c(f,i,r/b);return d}function c(a,b,c){c=0.5*(1-Math.cos(c*Math.PI));return a*(1-c)+b*c}for(var f=[],d=0,i=Math.pow(2,4);8>d;d++,i*=2){var m=b(a/i);if(m===l)break;f.push(m)}m=[].concat(f[0]);d=1;for(i=0.5;d<f.length;d++,i*=0.5)for(var r=0;r<a;r++)m[r]+=f[d][r]*i;for(d=0;d<m.length;d++)m[d]/=2;return m}
var T=qa(512);(function(){var a=l,b=l;u=tm.createClass({superClass:X,result:l,ha:0,pc:[],Oc:n,ne:l,re:0,Vc:0,init:function(){this.superInit();tm.app.Label('GL-Shooter 2',50).setPosition(240,160).addChildTo(this);tm.app.Label('version 1.0-beta',22).setPosition(432,192).setAlign('right').addChildTo(this);this.ne=tm.app.Label().setPosition(240,256).addChildTo(this);tm.app.Label('press space key').setPosition(240,576).addChildTo(this);this.addEventListener('enter',function(){this.Oc=n;for(var a=(''+Math.floor(t.Sc)).padding(16,
' '),b='',d=0;d<a.length;d+=4)b+=a.substring(d,d+4)+' ';this.ne.text='HIGH SCORE: '+b})},draw:function(a){a.fillStyle='black';a.fillRect(0,0,480,640)},update:function(a){this.Vd(80*Math.cos(0.01*this.ha)+240,80*Math.sin(0.01*this.ha)+320,0);this.Vd(80*Math.cos(0.01*this.ha+Math.PI)+240,80*Math.sin(0.01*this.ha+Math.PI)+320,1);(a.keyboard.getKeyDown('z')||a.keyboard.getKeyDown('space'))&&!this.Oc&&this.we();this.ha+=1},Vd:function(c,f,d){if(!this.Oc){a===l&&(a=H(80,1,0.8,tm.graphics.Canvas().resize(80,
80).setFillStyle(tm.graphics.RadialGradient(40,40,0,40,40,40).addColorStopList([{offset:0,color:'rgba(255,255,255,0.1)'},{offset:1,color:'rgba(155,  0,  0,0.0)'}]).toStyle()).fillRect(0,0,80,80).element));b===l&&(b=H(80,1,0.8,tm.graphics.Canvas().resize(80,80).setFillStyle(tm.graphics.RadialGradient(40,40,0,40,40,40).addColorStopList([{offset:0,color:'rgba(255,255,255,0.1)'},{offset:1,color:'rgba(  0,  0,155,0.0)'}]).toStyle()).fillRect(0,0,80,80).element));d=0===d?a.clone().addChildTo(this):b.clone().addChildTo(this);
d.speed=0.6;var i=S(0,2*Math.PI),m=U(0,20);d.setPosition(Math.cos(i)*m+c,Math.sin(i)*m+f);var r=this;d.update=function(){this.x+=Math.cos(i)*this.speed;this.y+=Math.sin(i)*this.speed;if(-50>this.x||530<this.x||-50>this.y||690<this.y){this.remove();var a=r.pc.indexOf(this);-1!==a&&r.pc.splice(a,1)}};this.pc.push(d)}},we:function(){Y(this,'MAIN MENU',['start','tutorial','setting','save score'],this.cg,this.re,['\u30b2\u30fc\u30e0\u3092\u958b\u59cb\u3057\u307e\u3059','\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u958b\u59cb\u3057\u307e\u3059',
'\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3059','\u30b2\u30fc\u30e0\u3092\u7d42\u4e86\u30579leap\u306b\u30b9\u30b3\u30a2\u3092\u767b\u9332\u3057\u307e\u3059'])},cg:function(a){4!==a&&(this.re=a);switch(a){case 0:this.tweener.clear().call(function(){this.Oc=k;for(var a=0,b=this.pc.length;a<b;a++)this.pc[a].speed=8}.bind(this)).wait(1E3).call(function(){t.$.start(2);t.replaceScene(t.$)}.bind(this));break;case 2:this.Cb();break;case 3:t.Gf()}},Cb:function(){Y(this,'SETTING',['bgm volume','sound volume',
'difficulty'],this.Ed,this.Vc,['BGM\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u307e\u3059','\u52b9\u679c\u97f3\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u307e\u3059','\u96e3\u6613\u5ea6\u3092\u8a2d\u5b9a\u3057\u307e\u3059'])},Ed:function(a){3!==a&&(this.Vc=a);switch(a){case 0:this.Fd();break;case 1:this.Gd();break;case 2:this.ig();break;default:this.we()}},Fd:function(){Y(this,'BGM VOLUME','012345'.split(''),this.Cd,t.Gc)},Cd:function(a){6!==a&&(t.Gc=a);this.Cb()},Gd:function(){Y(this,
'SE VOLUME','012345'.split(''),this.Dd,t.cc)},Dd:function(a){6!==a&&(t.cc=a);this.Cb()},ig:function(){Y(this,'DIFFICULTY',['easy','normal','hard','very hard','hell'],this.bg,t.fe,['\u521d\u5fc3\u8005\u3067\u3082\u5b89\u5fc3\u3057\u3066\u6311\u6226\u53ef\u80fd\u306a\u5165\u9580\u30b3\u30fc\u30b9','\u666e\u901a\u306e\u96e3\u6613\u5ea6\u3002easy\u3067\u306f\u7269\u8db3\u308a\u306a\u3044\u4eba\u3078','\u4e00\u822c\u7684\u306a\u5f3e\u5e55STG\u306e\u96e3\u6613\u5ea6','hard\u306f\u30cc\u30eb\u3059\u304e\u308b\u3068\u3044\u3046\u4eba\u5411\u3051',
'\u6b7b\u306c\u304c\u3088\u3044'])},bg:function(a){5!==a&&(t.fe=a);this.Cb()},toString:function(){return'gls2.TitleScene'}})})();tm.createClass({superClass:X,init:function(){this.superInit();tm.app.Label('This is ShipSelectScene').setAlign('center').setBaseline('middle').setPosition(240,320).addChildTo(this)}});A=tm.createClass({superClass:X,ba:l,score:0,xa:0,qa:0,Wc:0,Ca:0,wb:0,$c:l,va:l,Gb:3,Ae:0,Be:0,Bb:0,he:0,cb:0,hc:0,yf:6,Zb:n,ya:0,Ja:0,ra:n,oc:0,Yb:0,wd:l,xe:l,ie:l,td:l,ge:l,ae:l,Wf:l,Uc:l,bc:l,init:function(){A.jd!==l&&g(Error("class 'gls2.GameScene' is singleton!!"));this.superInit();A.jd=this;this.bc=ja(this);this.va=ka().fa;this.va.addChildTo(this);this.wd=A.Ib().addChildTo(this);this.ie=A.Ib().addChildTo(this);this.td=A.Ib().addChildTo(this);this.xe=A.Ib().addChildTo(this);this.ge=A.Ib().addChildTo(this);
this.ae=A.Ib().addChildTo(this);this.Wf=A.Pd(this).addChildTo(this);tm.Na.Hb.lc.Yd=this;this.Uc=tm.app.Object2D();this.Uc.addChildTo(this);this.Uc.update=function(a){this.eg(a)}.bind(this);this.addEventListener('exit',function(){this.bc.clear()})},addChild:function(a){a.Pa?this.td.addChild(a):a instanceof L?this.ae.addChild(a):a instanceof K?this.wd.addChild(a):a instanceof J?a.kb?this.wd.addChild(a):this.ie.addChild(a):a instanceof C?this.xe.addChild(a):a===this.Uc||a===this.va||a instanceof A.Ib||
a instanceof A.Pd?this.superClass.prototype.addChild.apply(this,arguments):(console.error('unknown type child.'),g(Error(a)))},update:function(a){this.$c.update(a.frame);this.ra&&(this.Yb-=1,0>=this.Yb&&this.mc());this.oc=Math.max(this.oc-1,0);0===a.frame%5&&this.bc.update();this.Ca-=B.Ne*B.Oe;0>=this.Ca&&(this.Ca=0,this.ra||1===this.ya?this.wb=this.qa=this.xa=0:(0<this.qa&&(0>=this.wb&&(this.wb=this.qa*B.Me),this.xa=this.xa*(this.qa-this.wb)/this.qa,this.qa-=this.wb),0>=this.qa&&(this.wb=this.qa=
this.xa=0)));if(a.keyboard.getKeyDown('escape'))this.app.replaceScene(u());else if(a.keyboard.getKeyDown('space'))this.Xc(0);else if(a.keyboard.getKeyDown('p')){var b=tm.graphics.Canvas();b.resize(480,640);b.clearColor('black');b.drawImage(this.va.va.element,0,0);b.drawImage(a.canvas.element,0,0);b.drawImage(this.bc.element,0,0);b.saveAsImage();this.Xc(0)}},eg:function(){this.ba.rb===n&&v.erase();var a;a=[].concat(J.Ia);for(var b=[].concat(G.Ia),c=b.length;b[--c]!==j;)for(var f=a.length;a[--f]!==
j;){var d=a[f],i=b[c];if(!(0>=d.wa)&&V(d,i)&&(i.Pc(1),i.remove(),d.Mb(this.ra?B.df:B.gf))){this.Bb+=1;this.ra===n&&this.gc(B.$e);this.Qc(d.kb,Q(d,this.ba)<B.dd,d.x,d.y,d.star);this.Vb(1);!this.ra&&1===this.ya?(i=~~(this.qa/B.cd)+1,this.ab(this.xa+d.score*i)):this.ab(this.xa+d.score);this.xa+=d.score;break}}b=this.ba.lb;if(this.ba.lb.visible){a=[].concat(J.Ia);a.sort(function(a,b){return a.y-b.y});for(f=a.length;a[--f]!==j;)if(d=a[f],!(0>=d.wa)&&V(d,b)){b.jg(d.y+d.boundingHeightBottom);d.Mb(this.ra?
B.cf:B.ef)?(this.Bb+=1,this.gc(B.Ye),this.Qc(d.kb,Q(d,this.ba)<B.dd,d.x,d.y,d.star),this.Vb(1),!this.ra&&1===this.ya?(i=~~(this.qa/B.cd)+1,this.ab(this.xa+d.score*i)):this.ab(this.xa+d.score),this.xa+=d.score):(this.Vb(0.01),this.Ca=Math.max(this.Ca,0.05),this.gc(B.Ze));b.Pc(2);break}c={x:this.ba.x,y:this.ba.y,boundingWidthLeft:50,boundingWidthRight:50,boundingHeightTop:100,boundingHeightBottom:40};a=[].concat(J.Ia);for(f=a.length;a[--f]!==j;)d=a[f],!(0>=d.wa)&&V(d,c)&&(d.Mb(this.ra?B.Ve:B.He)?(this.Bb+=
1,this.gc(B.We),this.Qc(d.kb,Q(d,this.ba)<B.dd,d.x,d.y,d.star),this.Vb(1),!this.ra&&1===this.ya?(i=~~(this.qa/B.cd)+1,this.ab(this.xa+d.score*i)):this.ab(this.xa+d.score),this.xa+=d.score):(this.Vb(0.01),this.Ca=Math.max(this.Ca,0.05),this.gc(B.Xe)),b.Sf(2,this.ba.x,this.ba.y-30))}if(this.Zb){v.erase();a=[].concat(J.Ia);for(f=a.length;a[--f]!==j;)d=a[f],!(0>=d.wa)&&(d.Ab()&&d.Mb(B.Je))&&(this.ab(d.score),this.Bb+=1);this.Ca=this.qa=0}if(this.ra){f=[].concat(G.Ia);for(d=f.length;f[--d]!==j;){i=f[d];
b=[].concat(L.Ia);for(a=b.length;b[--a]!==j;)c=b[a],0<i.wa&&V(i,c)&&(c.wa-=6-this.Ja,0>c.wa&&(c.Ya(),this.ab(B.Le),this.Vb(1),this.Qc(n,n,c.x,c.y,1)),i.wa-=1)}}if(this.ba.parent!==l&&this.ba.ac===n&&this.Zb===n&&0>=this.oc){for(f=L.Ia.length;L.Ia[--f]!==j;)if(a=L.Ia[f],V(a,this.ba)){this.ba.Mb();0<this.cb?(this.Ja=R(this.Ja-1,0,1),q.ka.sa.$rank=R(q.ka.sa.$rank-0.01,0,1),ea(this.ba,this).setPosition(this.ba.x,this.ba.y).addChildTo(this)):this.ue();break}for(f=J.Ia.length;J.Ia[--f]!==j;)if(d=J.Ia[f],
!(0>=d.wa)&&!d.kb&&V(d,this.ba)){this.ba.Mb();0<this.cb?(this.Ja=R(this.Ja-1,0,1),q.ka.sa.$rank=R(q.ka.sa.$rank-0.01,0,1),ea(this.ba,this).setPosition(this.ba.x,this.ba.y).addChildTo(this)):this.ue();break}}},Qc:function(a,b,c,f,d){a=a?na:ma;for(var i=0;i<d;i++)a(b).setPosition(c,f)},start:function(a){this.bc.kc.zf().clear();this.score=0;this.Gb=B.Od;this.cb=this.hc=B.Nd;this.Ja=this.ya=0;q.ka.sa.$rank=0;this.mc();this.Zb=n;this.ba!==l&&this.ba.parent!==l&&this.ba.remove();J.ic();G.ic();v.ic();for(var b=
[].concat(this.td.children),c=0;c<b.length;c++)b[c].remove();b=[].concat(this.ge.children);for(c=0;c<b.length;c++)b[c].remove();this.ba=C(this,a);this.mg(0)},mg:function(a){this.Qa('3...2...1...');this.Ja=this.Wc=this.Ca=this.qa=this.xa=0;this.$c=I.create(this,a);this.tweener.clear().wait(1E3).call(function(){this.Bd()}.bind(this))},Bd:function(){this.Qa("Let's go!");this.ba.setPosition(240,740).setFrameIndex(3).addChildTo(this);this.ba.rb=n;this.ba.ac=k;this.ba.tweener.clear().moveBy(0,-180,1E3,
'easeOutBack').call(function(){this.rb=k}.bind(this.ba)).wait(2E3).call(function(){this.ac=n}.bind(this.ba));this.cb=this.hc},ue:function(){w.Lc(this.ba.x,this.ba.y,this);this.Qa('I was shot down.');this.ba.rb=n;this.ba.remove();this.Gb-=1;this.wb=this.qa=this.Ca=0;this.Ja=R(this.Ja-3,0,1);q.ka.sa.$rank=R(q.ka.sa.$rank-0.03,0,1);0<this.Gb?this.tweener.clear().wait(1E3).call(function(){this.hc=Math.min(this.hc+1,this.yf);this.Bd()}.bind(this)):this.tweener.clear().wait(2E3).call(function(){this.hg()}.bind(this))},
Qf:function(){this.Qa('System rebooted.',k);this.Gb=B.Od;this.cb=this.hc=B.Nd;this.Ja=0;q.ka.sa.$rank=0;this.Bd()},yg:p(),Rf:function(){this.app.replaceScene(ta())},Cg:p(),ab:function(a){var b=this.score;this.score+=a;for(a=0;a<t.ke.length;a++){var c=t.ke[a];b<c&&c<=this.score&&this.Kf()}t.Sc=Math.max(t.Sc,this.score)},Vb:function(a){this.ra&&(a*=B.Pe);this.wb=0;this.qa+=a;this.Wc=Math.max(this.Wc,this.qa);1<=a&&(this.Ca=1)},gc:function(a){!(0<a&&1===this.ya)&&!(0>a&&0===this.ya)&&(this.ra&&(a*=B.bf),
this.ya=R(this.ya+a*B.af,0,1),1===this.ya?(0.5>Math.random()?this.Qa('HYPER SYSTEM, ready.',k):this.Qa('HYPER SYSTEM, stand by.',k),ia(this.ba).addChildTo(this)):0===this.ya&&this.mc())},kg:function(){0.5>Math.random()?this.Qa('HYPER SYSTEM start!!',k):this.Qa('start counting to system limit.',k);this.ra=k;this.ya=0;this.Ja=R(this.Ja+1,0,5);q.ka.sa.$rank=R(q.ka.sa.$rank+0.01*this.Ja,0,1);q.ka.sa.$hyperOff=B.Re;this.Yb=B.Md;this.oc=B.Ue;this.ba.Wb=this.ba.oe;this.ba.lb.rc('hyper');w.Tf(this.ba.x,this.ba.y,
this)},mc:function(){this.ra!==n&&(this.ra=n,ia(this.ba,k).addChildTo(this),this.ba.Wb=this.ba.ve,this.ba.lb.rc('blue'),q.ka.sa.$hyperOff=1,this.oc=B.Te,this.Yb=0,v.erase())},Kf:function(){this.Qa('extended.');this.Gb+=1},Zf:function(a){a.pe?(this.Be+=1,this.ab(B.kf*this.qa)):(this.Ae+=1,this.ab(B.jf*this.qa))},Qa:function(a,b){this.bc.kc.wf(a,b)},Xc:function(a){Y(this,'PAUSE',['resume','setting','exit game'],this.dg,a,['\u30b2\u30fc\u30e0\u3092\u518d\u958b\u3057\u307e\u3059','\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3059',
'\u30b2\u30fc\u30e0\u3092\u4e2d\u65ad\u3057\u3001\u30bf\u30a4\u30c8\u30eb\u753b\u9762\u306b\u623b\u308a\u307e\u3059'],n)},dg:function(a){switch(a){case 1:this.Cb();break;case 2:this.gg()}},Cb:function(){Y(this,'SETTING',['bgm volume','sound volume'],this.Ed,this.Vc,['BGM\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u307e\u3059','\u52b9\u679c\u97f3\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u307e\u3059'])},Ed:function(a){3!==a&&(this.Vc=a);switch(a){case 0:this.Fd();break;case 1:this.Gd();
break;default:this.Xc()}},gg:function(){Y(this,'REARY?',['yes','no'],this.$f,1,['\u30b2\u30fc\u30e0\u3092\u4e2d\u65ad\u3057\u3001\u30bf\u30a4\u30c8\u30eb\u753b\u9762\u306b\u623b\u308a\u307e\u3059','\u524d\u306e\u753b\u9762\u3078\u623b\u308a\u307e\u3059'],n)},$f:function(a){0===a?this.app.replaceScene(u()):this.Xc(1)},Fd:function(){Y(this,'BGM VOLUME','012345'.split(''),this.Cd,t.Gc)},Cd:function(a){6!==a&&(t.Gc=a);this.Cb(1)},Gd:function(){Y(this,'SE VOLUME','012345'.split(''),this.Dd,t.cc)},Dd:function(a){6!==
a&&(t.cc=a);this.Cb(1)},hg:function(){Y(this,'CONTINUE?',['yes','no'],this.ag,0,['\u30b7\u30b9\u30c6\u30e0\u3092\u518d\u8d77\u52d5\u3057\u3066\u51fa\u6483\u3057\u307e\u3059','\u4f5c\u6226\u5931\u6557\u3002\u9000\u5374\u3057\u307e\u3059'],n)},ag:function(a){switch(a){case 0:this.Qf();break;case 1:this.Rf()}},draw:p()});A.Ib=tm.createClass({superClass:tm.app.Object2D,init:function(){this.superInit()}});
A.Pd=tm.createClass({superClass:tm.app.CanvasElement,$:l,frame:0,init:function(a){this.superInit();this.$=a},update:function(a){this.frame=a.frame},draw:function(a){this.Cf(a);this.Df(a)},Cf:function(a){if(0<this.$.Ca){a.fillStyle='rgba(255,'+~~(255*this.$.Ca)+','+~~Math.min(255,512*this.$.Ca)+',0.5)';var b=500*this.$.Ca;a.fillRect(465,635-b,10,b)}},Df:function(a){1===this.$.ya?0===this.frame%2&&(a.fillStyle='rgba(255,255,255,0.6)',a.fillRect(5,628,200,9)):(a.fillStyle='rgba(255,255,0,0.3)',a.fillRect(5,
628,200,9),0<this.$.ya&&(a.fillStyle='rgba(255,255,100,1.0)',a.fillRect(5,628,200*this.$.ya,9)))}});A.jd=l;tm.createClass({superClass:X,init:function(){this.superInit()},update:p()});var ta=tm.createClass({superClass:X,init:function(){this.superInit();var a=tm.app.Label('GAME OVER');a.fillStyle='red';a.setPosition(240,320).addChildTo(this);this.interactive=k;this.addEventListener('enter',function(){this.tweener.clear().wait(5E3).call(function(){this.app.replaceScene(u())}.bind(this))})},update:function(a){a.keyboard.getKeyDown('z')&&a.replaceScene(u())},draw:function(a){a.clearColor('black')}});tm.createClass({superClass:X,init:function(){this.superInit()},update:p()});(function(){J=tm.createClass({superClass:tm.app.CanvasElement,frame:0,direction:0,speed:0,ba:l,$:l,$c:l,da:l,ca:l,wa:0,score:0,kb:n,erase:n,star:1,eb:k,Za:n,ad:l,init:function(b,c,f,d){this.superInit();this.addEventListener('completeattack',function(){this.sb()});this.addEventListener('added',function(){this.frame=0;a.push(this)});this.addEventListener('removed',function(){this.dispatchEvent(tm.event.Event('enemyconsumed'));var b=a.indexOf(this);-1!==b&&a.splice(b,1)});this.eb=k;this.Za=n;this.$=
b;this.ba=b.ba;this.$c=c;this.ca=f;this.da=d;this.score=100;this.erase=n;this.ca.ta.apply(this);this.da.ta.apply(this);this.altitude=this.kb?1:10;this.ad={x:0,y:0}},Nb:function(){this.ca.Nb.apply(this);this.da.Nb.apply(this);return this},sb:function(){this.ca.sb.apply(this);this.da.sb.apply(this)},update:function(){this.Za===n&&(0<=this.x-this.boundingWidthLeft&&480>this.x+this.boundingWidthRight&&0<=this.y-this.boundingHeightTop&&640>this.y+this.boundingHeightBottom)&&(this.Za=k,this.ca.Ob.apply(this),
this.da.Ob.apply(this));var a=this.x,c=this.y;this.ca.update.apply(this);this.da.update.apply(this);this.kb&&(this.x+=this.$.va.la,this.y+=this.$.va.ma);this.frame+=1;this.ad.x=this.x-a;this.ad.y=this.y-c},Mb:function(a){if(!this.Za)return n;this.wa-=a;return 0>=this.wa?(a=S(0,5),2>a?this.$.Qa('enemy destroy.'):4>a?this.$.Qa(this.name+' destroy.'):this.$.Qa('ETR reaction gone.'),this.erase&&v.erase(k),this.ca.Ya.apply(this),this.da.Ya.apply(this),k):n},draw:function(a){this.da.draw.call(this,a)},
Ab:function(){return 0<=this.x+this.width/2&&480>this.x-this.width/2&&0<=this.y+this.height/2&&640>this.y-this.height/2},fg:function(){return this.eb}});J.ic=function(){for(var b=[].concat(a),c=0,f=b.length;c<f;c++)b[c].remove()};var a=J.Ia=[]})();(function(){function a(){this.remove();this.kb=k;this.$.addChild(this);this.addEventListener('enterframe',function(){0.2>Math.random()&&w.Lc(this.x+U(-100,100),this.y+U(-40,40),this.$,{x:0,y:-3})});this.tweener.clear().to({altitude:0,y:this.y+200},2E3).call(function(){w.je(this.x,this.y,this.$);this.remove()}.bind(this))}function b(){this.remove();this.kb=k;this.$.addChild(this);this.addEventListener('enterframe',function(){0.2>Math.random()&&w.Lc(this.x+U(-100,100),this.y+U(-40,40),this.$,{x:0,y:-3})});
this.tweener.clear().to({altitude:0,y:this.y+200},2E3).call(function(){w.je(this.x,this.y,this.$);this.remove()}.bind(this))}function c(a,b){b.name=a;b.wa=f[a][0];b.score=f[a][1];b.kb=f[a][2];b.erase=f[a][3];b.star=f[a][4]}var f={kujo:[2,100,n,n,1],kiryu:[3,300,n,n,1],natsuki:[5,300,k,n,1],kise:[30,300,k,n,1],kurokawa:[60,3E3,n,n,5],akimoto:[700,1E4,n,k,10],yukishiro:[1500,5E4,n,k,20]};N=tm.createClass({ta:function(){this.name='abstract enemy';this.wa=9999},Nb:p(),sb:p(),update:p(),Ob:p(),draw:p(),
Ya:function(){w.Lc(this.x,this.y,this.$,this.ad);this.remove()}});N.za=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('kujo',this);this.na=d('tex1',64,64);this.boundingRadius=24},update:function(){this.scaleX=this.x<this.ba.x?-1:1},draw:function(a){2>this.frame%4?this.na.setFrameIndex(7):this.na.setFrameIndex(8);this.na.draw(a)}});N.za=N.za();N.ia=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('kiryu',this);this.na=d('tex1',64,64);this.boundingRadius=
24},update:function(){this.scaleX=this.x<this.ba.x?-1:1},draw:function(a){2>this.frame%4?this.na.setFrameIndex(9):this.na.setFrameIndex(10);this.na.draw(a)}});N.ia=N.ia();N.Ba=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('natsuki',this);this.na=d('tex1',48,48);this.boundingRadius=24},update:function(){switch(~~(this.dir/(0.25*Math.PI))){case 0:this.na.setFrameIndex(16,64,64);break;case 1:this.na.setFrameIndex(24,64,64);break;case 2:this.na.setFrameIndex(23,64,64);
break;case 3:this.na.setFrameIndex(11,64,64);break;case 4:this.na.setFrameIndex(12,64,64);break;case 5:this.na.setFrameIndex(13,64,64);break;case 6:this.na.setFrameIndex(14,64,64);break;case 7:this.na.setFrameIndex(15,64,64)}},draw:function(a){this.na.draw(a)},Ya:function(){w.Hf(this.x,this.y,this.$);this.remove()}});N.Ba=N.Ba();N.ob=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('kurokawa',this);this.na=d('tex1',128,128);this.na.srcRect.x=320;this.na.srcRect.y=128;
this.na.srcRect.width=128;this.na.srcRect.height=128;this.boundingWidth=100;this.boundingHeight=20},update:p(),draw:function(a){this.na.draw(a)},Ya:function(){w.If(this.x,this.y,this.$);this.remove()}});N.ob=N.ob();N.xc=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('akimoto',this);this.na=d('tex1',256,128);this.na.srcRect.x=64;this.na.srcRect.y=128;this.na.srcRect.width=256;this.na.srcRect.height=128;this.boundingWidth=200;this.boundingHeightBottom=10;this.boundingHeightTop=
60},update:p(),draw:function(a){this.na.draw(a)},Ya:function(){b.call(this)}});N.xc=N.xc();N.pa=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('kise',this);this.boundingHeight=this.boundingWidth=20},draw:function(a){a.strokeStyle='yellow';a.strokeRect(-10,-10,20,20)}});N.pa=N.pa();N.ec=tm.createClass({superClass:N,init:function(){this.superInit()},ta:function(){c('yukishiro',this);this.boundingWidth=200;this.boundingHeight=80},Ya:function(){b.call(this)},draw:function(a){a.fillStyle=
'yellow';a.fillRect(-100,-40,200,80)}});N.ec=N.ec();N.Qd=tm.createClass({superClass:N,init:function(){this.superInit()},Ya:function(){a.call(this)}});N.Qd=N.Qd();var d=tm.createClass({superClass:tm.app.Sprite,init:function(a,b,c){this.superInit(a,b,c)},draw:function(a){var b=this.srcRect;a.context.drawImage(this._image.element,b.x,b.y,b.width,b.height,-this.width*this.origin.x,-this.height*this.origin.y,this.width,this.height)}})})();(function(){function a(a){var b=[].concat(a._listeners.enterframe);if(b)for(var d=0,i=b.length;d<i;d++)b[d]&&b[d].zd&&a.removeEventListener('enterframe',b[d])}function b(a,b){var d=v[b].Kc();a.addEventListener('enterframe',d);a.addEventListener('completeattack',function(){this.removeEventListener('enterframe',d)})}O=tm.createClass({ta:p(),Nb:p(),sb:p(),update:p(),Ob:p(),Ya:function(){a(this)}});O.Ua=tm.createClass({superClass:O,init:function(){this.superInit()},Nb:function(){var a=S(64,192);this.tweener.clear().wait(U(10,
500)).move(this.x,a,7*a,'easeOutQuad').call(function(){b(this,'basic0-0')}.bind(this))},sb:function(){this.tweener.clear().wait(1E3).moveBy(0,-640,2E3,'easeInQuad').call(function(){this.remove()}.bind(this))}});O.Ua=O.Ua();O.tb=tm.createClass({superClass:O,init:function(){this.superInit()},Nb:function(){var a=S(192,320);this.tweener.clear().wait(U(10,500)).move(this.x,a,7*a,'easeOutQuad').call(function(){b(this,'basic0-0')}.bind(this))},sb:function(){this.tweener.clear().wait(1E3).moveBy(0,-640,2E3,
'easeInQuad').call(function(){this.remove()}.bind(this))}});O.tb=O.tb();O.ia=tm.createClass({superClass:O,init:function(){this.superInit()},ta:function(){this.angle=0.5*Math.PI;this.Jd=U(0,60);this.speed=0},update:function(){this.frame===this.Jd?this.speed=8:this.frame===this.Jd+10?b(this,'basic1-0'):this.Jd<this.frame&&this.y<this.ba.y&&(this.angle+=Math.atan2(this.ba.y-this.y,this.ba.x-this.x)<this.angle?-0.02:0.02,this.angle=R(this.angle,0.5,Math.PI-0.5));this.x+=Math.cos(this.angle)*this.speed;
this.y+=Math.sin(this.angle)*this.speed;!this.Ab()&&this.Za&&this.remove();if(9E4>Q(this,this.ba)||this.y>this.ba.y)this.eb=n}});O.ia=O.ia();O.qg=tm.createClass({superClass:O,init:function(){this.superInit()},ta:function(){this.speed=0.8;this.dir=0},Ob:function(){b(this,'basic2-0')},update:function(){this.x+=Math.cos(this.dir)*this.speed;this.y+=Math.sin(this.dir)*this.speed;this.Za&&!this.Ab()&&this.remove();this.eb=this.y<this.ba.y}});O.Sa=tm.createClass({superClass:O,init:function(){this.superInit()},
ta:function(){this.speed=0.7;this.dir=0.25*Math.PI},Ob:function(){b(this,'basic2-0')},update:function(){this.x+=Math.cos(this.dir)*this.speed;this.y+=Math.sin(this.dir)*this.speed;this.Za&&!this.Ab()&&this.remove();this.eb=this.y<this.ba.y}});O.Sa=O.Sa();O.Jb=tm.createClass({superClass:O,init:function(){this.superInit()},ta:function(){this.speed=1;this.dir=Math.PI},Ob:function(){b(this,'basic2-0')},update:function(){this.x+=Math.cos(this.dir)*this.speed;this.y+=Math.sin(this.dir)*this.speed;this.Za&&
!this.Ab()&&this.remove();this.eb=this.y<this.ba.y}});O.Jb=O.Jb();O.pa=tm.createClass({superClass:O,init:function(){this.superInit()},ta:function(){this.speed=1;this.dir=Math.PI},Ob:function(){b(this,'basic3-0')},update:function(){this.Za&&!this.Ab()&&this.remove();this.eb=this.y<this.ba.y}});O.pa=O.pa();O.pb=tm.createClass({superClass:O,init:function(){this.superInit()},ta:function(){this.tweener.clear().moveBy(0,320,800,'easeOutQuad').call(function(){b(this,'kurokawa-1')}.bind(this))},update:function(){this.y+=
0.5;this.Za&&!this.Ab()&&this.remove();this.eb=this.y<this.ba.y}});O.pb=O.pb();O.yc=tm.createClass({superClass:O,init:function(){this.superInit()},ta:function(){this.tweener.clear().moveBy(0,320,1800,'easeOutQuad').call(function(){b(this,'komachi-1')}.bind(this))},update:function(){this.y+=0.3;this.Za&&!this.Ab()&&this.remove();this.eb=this.y<this.ba.y}});O.yc=O.yc();O.ff=tm.createClass({superClass:O,Hd:l,init:function(a){this.superInit();this.Hd=a},ta:function(){this.ud=this.Ce=n;this.tweener.clear().move(240,
192,1200,'easeOutQuad').call(function(){this.Ce=k;this.sb();var a=function(){var b=2*Math.random()*Math.PI,d=S(48,144);this.tweener.move(240+Math.cos(b)*d,192+0.5*Math.sin(b)*d,3E3,'easeInOutQuad').call(a)}.bind(this);a()}.bind(this))},update:function(){if(!(this.Ce===n||0>=this.wa)&&1500<this.frame&&this.ud===n)console.log('end'),this.ud=k,a(this),this.tweener.clear().move(this.x,-100,1200,'easeInQuad').call(function(){this.remove()}.bind(this))},sb:function(){if(!this.ud){var a=this.ca.Hd.shift();
b(this,a);this.ca.Hd.push(a)}}});O.ec=O.ff(['honoka-1'])})();var Z=O,$=N;
ga={'heri1-left':[{ca:Z.Ua,da:$.ia,x:48,y:-100},{ca:Z.tb,da:$.ia,x:96,y:-100},{ca:Z.Ua,da:$.ia,x:144,y:-100},{ca:Z.tb,da:$.ia,x:192,y:-100},{ca:Z.Ua,da:$.ia,x:240,y:-100}],'heri1-center':[{ca:Z.Ua,da:$.ia,x:144,y:-100},{ca:Z.tb,da:$.ia,x:192,y:-100},{ca:Z.Ua,da:$.ia,x:240,y:-100},{ca:Z.tb,da:$.ia,x:288,y:-100},{ca:Z.Ua,da:$.ia,x:336,y:-100}],'heri1-right':[{ca:Z.Ua,da:$.ia,x:240,y:-100},{ca:Z.tb,da:$.ia,x:288,y:-100},{ca:Z.Ua,da:$.ia,x:336,y:-100},{ca:Z.tb,da:$.ia,x:384,y:-100},{ca:Z.Ua,da:$.ia,x:432,
y:-100}],'heri2-left':[{ca:Z.ia,da:$.za,x:48,y:-100},{ca:Z.ia,da:$.za,x:96,y:-100},{ca:Z.ia,da:$.za,x:144,y:-100},{ca:Z.ia,da:$.za,x:192,y:-100},{ca:Z.ia,da:$.za,x:240,y:-100}],'heri2-center':[{ca:Z.ia,da:$.za,x:144,y:-100},{ca:Z.ia,da:$.za,x:192,y:-100},{ca:Z.ia,da:$.za,x:240,y:-100},{ca:Z.ia,da:$.za,x:288,y:-100},{ca:Z.ia,da:$.za,x:336,y:-100}],'heri2-right':[{ca:Z.ia,da:$.za,x:240,y:-100},{ca:Z.ia,da:$.za,x:288,y:-100},{ca:Z.ia,da:$.za,x:336,y:-100},{ca:Z.ia,da:$.za,x:384,y:-100},{ca:Z.ia,da:$.za,
x:432,y:-100}],'tankRD-left':[{ca:Z.Sa,da:$.Ba,x:78,y:-50},{ca:Z.Sa,da:$.Ba,x:28,y:-100},{ca:Z.Sa,da:$.Ba,x:-22,y:-150},{ca:Z.Sa,da:$.Ba,x:-72,y:-200},{ca:Z.Sa,da:$.Ba,x:-122,y:-250}],'tankRD-center':[{ca:Z.Sa,da:$.Ba,x:222,y:-50},{ca:Z.Sa,da:$.Ba,x:172,y:-100},{ca:Z.Sa,da:$.Ba,x:122,y:-150},{ca:Z.Sa,da:$.Ba,x:72,y:-200},{ca:Z.Sa,da:$.Ba,x:22,y:-250}],'tankL-top':[{ca:Z.Jb,da:$.Ba,x:550,y:-128},{ca:Z.Jb,da:$.Ba,x:620,y:-128},{ca:Z.Jb,da:$.Ba,x:690,y:-128},{ca:Z.Jb,da:$.Ba,x:760,y:-128},{ca:Z.Jb,da:$.Ba,
x:830,y:-128}],'cannon-0':[{ca:Z.pa,da:$.pa,x:48,y:-100}],'cannon-1':[{ca:Z.pa,da:$.pa,x:96,y:-100}],'cannon-2':[{ca:Z.pa,da:$.pa,x:144,y:-100}],'cannon-3':[{ca:Z.pa,da:$.pa,x:192,y:-100}],'cannon-4':[{ca:Z.pa,da:$.pa,x:240,y:-100}],'cannon-5':[{ca:Z.pa,da:$.pa,x:288,y:-100}],'cannon-6':[{ca:Z.pa,da:$.pa,x:336,y:-100}],'cannon-7':[{ca:Z.pa,da:$.pa,x:384,y:-100}],'cannon-8':[{ca:Z.pa,da:$.pa,x:432,y:-100}],'fighter-m-0':[{ca:Z.pb,da:$.ob,x:96,y:-192}],'fighter-m-1':[{ca:Z.pb,da:$.ob,x:144,y:-192}],
'fighter-m-2':[{ca:Z.pb,da:$.ob,x:192,y:-192}],'fighter-m-3':[{ca:Z.pb,da:$.ob,x:240,y:-192}],'fighter-m-4':[{ca:Z.pb,da:$.ob,x:288,y:-192}],'fighter-m-5':[{ca:Z.pb,da:$.ob,x:336,y:-192}],'fighter-m-6':[{ca:Z.pb,da:$.ob,x:384,y:-192}],'komachi-0':[{ca:Z.yc,da:$.xc,x:192,y:-192}],'komachi-1':[{ca:Z.yc,da:$.xc,x:288,y:-192}],yukishiro:[{ca:Z.ec,da:$.ec,x:240,y:-100}]};(function(){function a(a,b,c,d,f){return h.action([h.ga(h.direction(a,'absolute'),c,d,f,j,j),h.repeat(12,[h.ga(h.direction((b-a)/12,'sequence'),c,d,f,j,j)])])}function b(a,b,c,d,f){return h.action([h.ga(h.direction(b),d,f,j,j,j),h.repeat(a,[h.ga(h.direction((c-b)/a,'sequence'),d,f,j,j,j)])])}function c(a){return h.ga(h.direction(0),a||i,h.ea({frame:0}))}function f(a){return h.ga(h.direction(0),a||i,h.ea)}function d(a){return h.speed('$rank*2.0 + 1.40 + ('+(a===j?0:a)+'*0.1)')}function i(a){return h.speed('$rank*2.0 + 1.10 + ('+
(a===j?0:a)+'*0.1)')}function m(a){return h.speed('$rank*2.0 + 0.80 + ('+(a===j?0:a)+'*0.1)')}function r(a){return h.speed('$rank*2.0 + 0.50 + ('+(a===j?0:a)+'*0.1)')}function s(a){return h.wait(a+'*(1-$rank)*$hyperOff')}v={};var h=q.oa;v['basic0-0']=new q.Aa({top:h.action([f])});v['basic0-4']=new q.Aa({top:h.action([h.repeat(3,[h.repeat(5,[h.ga(h.direction(-20),h.speed('$loop.count*0.06+0.75'),h.ea),h.ga(h.direction(0),h.speed('$loop.count*0.06+0.75'),h.ea),h.ga(h.direction(20),h.speed('$loop.count*0.06+0.75'),
h.ea)]),s(40)])])});v['basic1-0']=new q.Aa({top:h.action([h.repeat(999,[s(20),f(function(a){return h.speed('$rank*2.0 + 1.70 + ('+(a===j?0:a)+'*0.1)')})])])});v['basic2-0']=new q.Aa({top:h.action([h.wait('120'),h.repeat(999,[s(50),f(d)])])});v['basic3-0']=new q.Aa({top:h.action([h.wait(20),h.repeat(999,[s(100),c(d(0)),c(d(1)),c(d(2))])])});v['kurokawa-1']=new q.Aa({top0:h.action([h.repeat(3,[h.repeat(3,[h.repeat(3,[h.ga(h.direction(-45),d('$loop.count'),h.ea({frame:2}),h.offsetX(-45),h.ua(k)),h.ga(h.direction(-15),
d('$loop.count'),h.ea({frame:2}),h.offsetX(-45),h.ua(k)),h.ga(h.direction(15),d('$loop.count'),h.ea({frame:2}),h.offsetX(-45),h.ua(k)),h.ga(h.direction(45),d('$loop.count'),h.ea({frame:2}),h.offsetX(-45),h.ua(k)),h.ga(h.direction(-45),d('$loop.count'),h.ea({frame:2}),h.offsetX(45),h.ua(k)),h.ga(h.direction(-15),d('$loop.count'),h.ea({frame:2}),h.offsetX(45),h.ua(k)),h.ga(h.direction(15),d('$loop.count'),h.ea({frame:2}),h.offsetX(45),h.ua(k)),h.ga(h.direction(45),d('$loop.count'),h.ea({frame:2}),h.offsetX(45),
h.ua(k))]),s(90)]),s(120)])]),top1:h.action([h.repeat(3,[h.ga(h.direction(0),d,h.ea({bb:k,frame:3}),h.offsetX(-45),h.ua(k)),s(45),h.ga(h.direction(0),d,h.ea({bb:k,frame:3}),h.offsetX(45),h.ua(k)),s(45)])])});v['komachi-1']=new q.Aa({top0:h.action([h.repeat(20,[h.ga(h.direction(210,'absolute'),r(1),h.ea,h.offsetX(-40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(-40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(-40)),h.repeat(57,[s(8),h.ga(h.direction(-720/57,'sequence'),r(1),h.ea,
h.offsetX(-40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(-40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(-40))])])]),top1:h.action([h.repeat(20,[h.ga(h.direction(-210,'absolute'),r(1),h.ea,h.offsetX(40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(40)),h.repeat(57,[s(8),h.ga(h.direction(720/57,'sequence'),r(1),h.ea,h.offsetX(40)),h.ga(h.direction(120,'sequence'),r(1),h.ea,h.offsetX(40)),h.ga(h.direction(120,
'sequence'),r(1),h.ea,h.offsetX(40))])])]),top2:h.action([h.repeat(70,[h.ga(h.direction(0),i(0),h.ea({bb:k,frame:0}),h.offsetX(-110),h.ua(k)),h.repeat(6,[s(3),h.ga(h.direction(0,'sequence'),i(0),h.ea({bb:k,frame:0}),h.offsetX(-110),h.ua(k))]),s(10),h.ga(h.direction(0),i(0),h.ea({bb:k,frame:0}),h.offsetX(110),h.ua(k)),h.repeat(6,[s(3),h.ga(h.direction(0,'sequence'),i(0),h.ea({bb:k,frame:0}),h.offsetX(110),h.ua(k))]),s(10)])])});v['honoka-1']=new q.Aa({top0:h.action([h.wait(60),h.repeat(10,[b(6,-40,
40,i,h.ea({bb:k,frame:4})),s(30),b(7,-40,40,m,h.ea({bb:k,frame:4})),s(30)])]),top1:h.action([h.wait(60),h.repeat(5,[b(2,-2,2,m(2),h.ea({frame:1})),b(3,-3,3,m(3),h.ea({frame:1})),b(4,-4,4,m(4),h.ea({frame:1})),b(5,-5,5,m(5),h.ea({frame:1})),s(110)])]),top2:h.action([h.repeat(20,[a(-10,-170,r,h.ea({bb:k,frame:0}),h.offsetX(-80)),s(30)])]),top3:h.action([h.repeat(20,[a(10,170,r,h.ea({bb:k,frame:0}),h.offsetX(80)),s(30)])])});v.ta=function(){for(var a=0;800>a;a++)z.push(L());a=v.Jc=tm.Na.Hb.lc;a.Ad=function(a){return!(a instanceof
L)||!(-50>a.x||530<a.x||-50>a.y||690<a.y)};a.$d=function(a){var b=z.shift(0);if(b)return M.push(b),b.setFrameIndex(a.frame===j?1:a.frame),a.bb?(b.scaleX=1,b.scaleY=1,b.Fb=n,b.update=function(){this.rotation+=15}):(b.scaleX=0.8,b.scaleY=1.5,b.Fb=k),b;console.warn('\u5f3e\u304c\u8db3\u308a\u306a\u3044\uff01')};a.ce=function(a){return-80<=a.x&&560>a.x&&-80<=a.y&&720>a.y};a.Rb=4;q.ka.sa.$rank=0;q.ka.sa.$hyperOff=1};v.erase=function(a){for(var b=[].concat(M),c=0,d=b.length;c<d;c++)a&&ma(n).setPosition(b[c].x,
b[c].y),b[c].Ya()};v.ic=function(){for(var a=[].concat(M),b=0,c=a.length;b<c;b++)a[b].remove()};L=tm.createClass({superClass:tm.app.Sprite,wa:0,init:function(){this.superInit('tex0',20,20);this.boundingRadius=7;this.addEventListener('added',function(){this.wa=B.Ke});this.addEventListener('removed',function(){z.push(this);var a=M.indexOf(this);-1!==a&&M.splice(a,1);this.clearEventListener('enterframe')})},Ya:function(){var a=H(10,1,0.92,tm.graphics.Canvas().resize(10,10).setFillStyle(tm.graphics.RadialGradient(5,
5,0,5,5,5).addColorStopList([{offset:0,color:'rgba(255,100,100,0.0)'},{offset:0.3,color:'rgba(255,100,100,0.0)'},{offset:0.9,color:'rgba(255,180,180,1.0)'},{offset:1,color:'rgba(255,100,100,0.0)'}]).toStyle()).fillRect(0,0,10,10).element).setScale(0.1,0.1).setPosition(this.x,this.y);a.addEventListener('enterframe',function(){this.scaleX+=0.1;this.scaleY+=0.1});a.addChildTo(this.parent);this.remove()}});var z=[],M=L.Ia=[]})();var R,S,pa,U,ua;R=function(a,b,c){return a<b?b:a>c?c:a};ua=Math.PI/180;pa=function(a){return a*ua};U=function(a,b){return window.Math.floor(Math.random()*(b-a+1))+a};S=function(a,b){return window.Math.random()*(b-a)+a};
